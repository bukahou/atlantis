{
  "meta": {
    "title": "脆弱性スキャン",
    "description": "SAST、DASTとSCAツール",
    "order": 2,
    "tags": ["脆弱性", "SAST", "DAST", "SCA"]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "コアコンセプト",
      "items": [
        "SAST：静的アプリケーションセキュリティテスト（コードスキャン）",
        "DAST：動的アプリケーションセキュリティテスト（ランタイムスキャン）",
        "SCA：ソフトウェア構成分析（依存関係の脆弱性検出）",
        "ペネトレーションテスト：実際の攻撃をシミュレート"
      ]
    },
    {
      "type": "comparison",
      "title": "SAST vs DAST vs SCA",
      "columns": [
        {
          "title": "SAST",
          "color": "from-blue-500 to-indigo-500",
          "items": [
            { "label": "タイミング", "description": "開発フェーズ" },
            { "label": "対象", "description": "ソースコード" },
            { "label": "利点", "description": "早期発見、網羅的" },
            { "label": "ツール", "description": "SonarQube、Semgrep" }
          ]
        },
        {
          "title": "DAST",
          "color": "from-green-500 to-teal-500",
          "items": [
            { "label": "タイミング", "description": "テスト/本番フェーズ" },
            { "label": "対象", "description": "稼働中のアプリ" },
            { "label": "利点", "description": "ランタイム問題を発見" },
            { "label": "ツール", "description": "OWASP ZAP、Burp" }
          ]
        },
        {
          "title": "SCA",
          "color": "from-purple-500 to-pink-500",
          "items": [
            { "label": "タイミング", "description": "ビルドフェーズ" },
            { "label": "対象", "description": "サードパーティ依存関係" },
            { "label": "利点", "description": "既知の脆弱性を発見" },
            { "label": "ツール", "description": "Snyk、Dependabot" }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "GitHub Actionsセキュリティスキャン",
      "language": "yaml",
      "code": "name: Security Scan\n\non:\n  push:\n    branches: [main]\n  pull_request:\n    branches: [main]\n\njobs:\n  # SAST - コードスキャン\n  sast:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Run Semgrep\n        uses: returntocorp/semgrep-action@v1\n        with:\n          config: p/security-audit\n          \n  # SCA - 依存関係スキャン\n  sca:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Run Snyk\n        uses: snyk/actions/node@master\n        env:\n          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}\n        with:\n          command: test\n          args: --severity-threshold=high\n          \n  # コンテナスキャン\n  container-scan:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Build image\n        run: docker build -t myapp:${{ github.sha }} .\n        \n      - name: Run Trivy\n        uses: aquasecurity/trivy-action@master\n        with:\n          image-ref: myapp:${{ github.sha }}\n          severity: 'CRITICAL,HIGH'\n          exit-code: '1'"
    },
    {
      "type": "codeBlock",
      "title": "よく使うスキャンツール",
      "language": "bash",
      "code": "# SAST - Semgrep\nsemgrep scan --config auto .\n\n# SCA - npm audit\nnpm audit --audit-level=high\n\n# SCA - Snyk\nsnyk test\n\n# コンテナスキャン - Trivy\ntrivy image myapp:latest\n\n# DAST - OWASP ZAP (CLI)\nzap-cli quick-scan https://example.com\n\n# インフラスキャン - Checkov\ncheckov -d ./terraform/"
    },
    {
      "type": "table",
      "title": "脆弱性の重大度",
      "highlightFirst": true,
      "headers": ["レベル", "CVSS", "修正期限", "例"],
      "rows": [
        ["Critical", "9.0-10.0", "24時間", "RCE、未認証アクセス"],
        ["High", "7.0-8.9", "7日", "SQLインジェクション、XSS"],
        ["Medium", "4.0-6.9", "30日", "情報漏洩"],
        ["Low", "0.1-3.9", "90日", "ベストプラクティス問題"]
      ]
    },
    {
      "type": "list",
      "title": "統合アドバイス",
      "style": "check",
      "items": [
        { "label": "CI/CD統合", "description": "コミット毎に自動スキャン" },
        { "label": "ブロックポリシー", "description": "Critical/High脆弱性はマージをブロック" },
        { "label": "定期フルスキャン", "description": "毎週本番環境をスキャン" },
        { "label": "脆弱性追跡", "description": "JIRA/Issuesと統合" }
      ]
    }
  ],
  "relatedTopics": ["DevSecOps", "CI/CD", "ペネトレーションテスト"]
}
