{
  "meta": {
    "title": "MySQL",
    "description": "MySQL データベースのコア概念、クエリ最適化と高可用性アーキテクチャ",
    "order": 1,
    "tags": ["MySQL", "SQL", "リレーショナルデータベース"]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "コアコンセプト",
      "items": [
        "MySQL は最も人気のあるオープンソースリレーショナルデータベース",
        "InnoDB エンジンはトランザクションと行ロックをサポート",
        "B+Tree インデックス構造、カバリングインデックスをサポート",
        "MVCC マルチバージョン同時実行制御"
      ]
    },
    {
      "type": "cards",
      "title": "ストレージエンジン",
      "layout": "grid",
      "columns": 2,
      "items": [
        {
          "title": "InnoDB",
          "badge": "推奨",
          "badgeColor": "green",
          "points": [
            "ACID トランザクションサポート",
            "行レベルロック、高並列性",
            "外部キー制約",
            "クラッシュリカバリ"
          ]
        },
        {
          "title": "MyISAM",
          "badge": "レガシー",
          "badgeColor": "gray",
          "points": [
            "トランザクション非対応",
            "テーブルレベルロック",
            "全文インデックス",
            "読み取り専用シナリオ向け"
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "インデックスタイプ",
      "language": "sql",
      "code": "-- B+Tree インデックス (デフォルト)\nCREATE INDEX idx_name ON users(name);\n\n-- ユニークインデックス\nCREATE UNIQUE INDEX idx_email ON users(email);\n\n-- 複合インデックス\nCREATE INDEX idx_name_age ON users(name, age);\n\n-- 全文インデックス\nCREATE FULLTEXT INDEX idx_content ON articles(content);\n\n-- 最左プレフィックス原則\n-- インデックス (a, b, c)\nWHERE a = 1                  -- インデックス使用\nWHERE a = 1 AND b = 2        -- インデックス使用\nWHERE b = 2                  -- インデックス不使用"
    },
    {
      "type": "comparison",
      "title": "トランザクション分離レベル",
      "columns": [
        {
          "title": "READ UNCOMMITTED",
          "color": "from-red-500 to-orange-500",
          "items": [
            { "label": "問題", "description": "ダーティリード" },
            { "label": "性能", "description": "最高" }
          ]
        },
        {
          "title": "READ COMMITTED",
          "color": "from-amber-500 to-yellow-500",
          "items": [
            { "label": "問題", "description": "ノンリピータブルリード" },
            { "label": "性能", "description": "高め" }
          ]
        },
        {
          "title": "REPEATABLE READ",
          "color": "from-green-500 to-emerald-500",
          "items": [
            { "label": "問題", "description": "ファントムリード" },
            { "label": "性能", "description": "デフォルトレベル" }
          ]
        },
        {
          "title": "SERIALIZABLE",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            { "label": "問題", "description": "なし" },
            { "label": "性能", "description": "最低" }
          ]
        }
      ]
    },
    {
      "type": "table",
      "title": "ロックタイプ",
      "highlightFirst": true,
      "headers": ["ロックタイプ", "粒度", "並列性", "適用シナリオ"],
      "rows": [
        ["共有ロック (S)", "行", "複数読み取り可", "SELECT ... LOCK IN SHARE MODE"],
        ["排他ロック (X)", "行", "排他", "SELECT ... FOR UPDATE"],
        ["ギャップロック", "範囲", "ファントムリード防止", "REPEATABLE READ レベル"],
        ["テーブルロック", "テーブル", "低", "DDL 操作"]
      ]
    },
    {
      "type": "codeBlock",
      "title": "クエリ最適化",
      "language": "sql",
      "code": "-- 実行計画分析\nEXPLAIN SELECT * FROM orders WHERE user_id = 1;\n\n-- SELECT * を避ける\nSELECT id, name, email FROM users;\n\n-- インデックス列での関数使用を避ける\n-- 誤り: WHERE YEAR(created_at) = 2024\n-- 正解:\nWHERE created_at >= '2024-01-01' AND created_at < '2025-01-01';\n\n-- バルクインサート\nINSERT INTO users (name, email) VALUES\n('user1', 'u1@test.com'),\n('user2', 'u2@test.com');"
    },
    {
      "type": "flow",
      "title": "主従レプリケーション",
      "direction": "horizontal",
      "steps": [
        { "label": "マスター書き込み", "description": "Binlog", "color": "bg-blue-500" },
        { "label": "ログ転送", "description": "IO Thread", "color": "bg-purple-500" },
        { "label": "スレーブ受信", "description": "Relay Log", "color": "bg-cyan-500" },
        { "label": "リプレイ適用", "description": "SQL Thread", "color": "bg-green-500" }
      ]
    },
    {
      "type": "list",
      "title": "高可用性ソリューション",
      "style": "check",
      "items": [
        { "label": "主従レプリケーション", "description": "非同期/セミ同期/グループレプリケーション" },
        { "label": "読み書き分離", "description": "マスター書き込み、スレーブ読み取り、ProxySQL/MaxScale" },
        { "label": "シャーディング", "description": "ShardingSphere、MyCat、Vitess" },
        { "label": "MGR", "description": "MySQL Group Replication マルチマスター" }
      ]
    }
  ],
  "relatedTopics": ["PostgreSQL", "インデックス最適化", "シャーディング"]
}
