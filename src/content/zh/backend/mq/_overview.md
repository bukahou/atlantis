---
title: 消息队列
description: Kafka、RabbitMQ 与 Redis 消息中间件技术
keyPoints:
  - 消息模式与语义保证
  - 发布订阅与点对点
  - 消息可靠性与幂等
  - 消息积压与性能优化
relatedTopics:
  - 微服务架构
  - 事件驱动设计
  - 分布式系统
---

# 消息队列知识体系

## 核心概念

消息队列是分布式系统中实现异步通信和解耦的核心组件。

### 消息队列价值

```
核心能力
┌─────────────────────────────────────────┐
│  异步解耦  │  服务间不直接依赖          │
├────────────┼────────────────────────────┤
│  削峰填谷  │  缓冲突发流量              │
├────────────┼────────────────────────────┤
│  可靠传递  │  保证消息不丢失            │
├────────────┼────────────────────────────┤
│  广播通知  │  一对多消息分发            │
└────────────┴────────────────────────────┘

消息模式
┌──────────────────────────────────────────┐
│   点对点 (P2P)                           │
│   Producer → Queue → Consumer            │
│   一条消息只被一个消费者处理              │
├──────────────────────────────────────────┤
│   发布订阅 (Pub/Sub)                     │
│   Publisher → Topic → Subscriber1        │
│                    → Subscriber2         │
│   一条消息被多个订阅者接收                │
└──────────────────────────────────────────┘
```

## 学习路径

### Kafka

- **核心概念** - Topic, Partition, Consumer Group
- **消息模型** - 日志型消息存储
- **性能优化** - 批量、压缩、零拷贝
- **应用场景** - 日志收集、流处理

### RabbitMQ

- **核心概念** - Exchange, Queue, Binding
- **消息确认** - ACK 机制
- **高可用** - 镜像队列、集群
- **应用场景** - 任务队列、RPC

### Redis 消息

- **List** - 简单队列
- **Pub/Sub** - 发布订阅
- **Stream** - 持久化消息流

## 选型指南

| 场景 | 推荐方案 | 原因 |
|-----|---------|------|
| 日志收集 | Kafka | 高吞吐、持久化 |
| 任务队列 | RabbitMQ | 灵活路由、ACK |
| 简单消息 | Redis | 轻量、低延迟 |
| 事件溯源 | Kafka | 日志保留 |

## 最佳实践

1. **幂等消费** - 处理消息重复
2. **消息顺序** - 单分区保序
3. **监控告警** - 积压监控
4. **死信处理** - 失败消息处理
