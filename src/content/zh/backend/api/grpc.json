{
  "meta": {
    "title": "gRPC",
    "description": "高性能 RPC 框架与 Protocol Buffers",
    "order": 3,
    "tags": ["API", "gRPC", "微服务"]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "核心概念",
      "items": [
        "gRPC 是 Google 开源的高性能 RPC 框架",
        "基于 HTTP/2 协议，支持双向流",
        "使用 Protocol Buffers 序列化",
        "支持多种语言，适合微服务通信"
      ]
    },
    {
      "type": "comparison",
      "title": "gRPC vs REST",
      "columns": [
        {
          "title": "gRPC",
          "color": "from-green-500 to-emerald-500",
          "items": [
            { "label": "协议", "description": "HTTP/2" },
            { "label": "格式", "description": "Protocol Buffers" },
            { "label": "性能", "description": "高（二进制）" },
            { "label": "流式", "description": "支持双向流" }
          ]
        },
        {
          "title": "REST",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            { "label": "协议", "description": "HTTP/1.1" },
            { "label": "格式", "description": "JSON" },
            { "label": "性能", "description": "较低（文本）" },
            { "label": "流式", "description": "不原生支持" }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "Proto 文件定义",
      "language": "protobuf",
      "code": "syntax = \"proto3\";\n\npackage user;\n\nservice UserService {\n  // 一元 RPC\n  rpc GetUser(GetUserRequest) returns (User);\n  rpc CreateUser(CreateUserRequest) returns (User);\n  \n  // 服务端流\n  rpc ListUsers(ListUsersRequest) returns (stream User);\n  \n  // 客户端流\n  rpc UploadUsers(stream User) returns (UploadResult);\n  \n  // 双向流\n  rpc Chat(stream Message) returns (stream Message);\n}\n\nmessage User {\n  int64 id = 1;\n  string name = 2;\n  string email = 3;\n  repeated string roles = 4;\n}\n\nmessage GetUserRequest {\n  int64 id = 1;\n}\n\nmessage CreateUserRequest {\n  string name = 1;\n  string email = 2;\n}"
    },
    {
      "type": "cards",
      "title": "通信模式",
      "layout": "grid",
      "columns": 2,
      "items": [
        {
          "title": "一元 RPC",
          "badge": "Unary",
          "badgeColor": "blue",
          "points": [
            "请求-响应模式",
            "类似 REST API",
            "最常用模式"
          ]
        },
        {
          "title": "服务端流",
          "badge": "Server Stream",
          "badgeColor": "green",
          "points": [
            "一次请求",
            "多次响应",
            "适合大数据返回"
          ]
        },
        {
          "title": "客户端流",
          "badge": "Client Stream",
          "badgeColor": "amber",
          "points": [
            "多次请求",
            "一次响应",
            "适合批量上传"
          ]
        },
        {
          "title": "双向流",
          "badge": "Bidirectional",
          "badgeColor": "purple",
          "points": [
            "双向实时通信",
            "独立发送接收",
            "聊天、游戏"
          ]
        }
      ]
    },
    {
      "type": "table",
      "title": "Protocol Buffers 类型",
      "highlightFirst": true,
      "headers": ["类型", "默认值", "说明"],
      "rows": [
        ["int32/int64", "0", "整数"],
        ["float/double", "0.0", "浮点数"],
        ["bool", "false", "布尔"],
        ["string", "\"\"", "字符串"],
        ["bytes", "空", "字节数组"],
        ["repeated", "空列表", "数组"],
        ["map", "空 map", "键值对"]
      ]
    },
    {
      "type": "list",
      "title": "最佳实践",
      "style": "check",
      "items": [
        { "label": "版本兼容", "description": "新增字段使用新编号，不删除旧字段" },
        { "label": "错误处理", "description": "使用 gRPC 状态码和详细错误信息" },
        { "label": "健康检查", "description": "实现 grpc.health.v1 健康检查服务" },
        { "label": "超时设置", "description": "始终设置 deadline/timeout" },
        { "label": "负载均衡", "description": "使用客户端负载均衡或服务网格" }
      ]
    }
  ],
  "relatedTopics": ["微服务", "Protocol Buffers", "服务网格"]
}
