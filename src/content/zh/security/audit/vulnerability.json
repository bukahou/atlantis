{
  "meta": {
    "title": "漏洞扫描",
    "description": "SAST、DAST 与 SCA 工具",
    "order": 2,
    "tags": ["漏洞", "SAST", "DAST", "SCA"]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "核心概念",
      "items": [
        "SAST：静态应用安全测试（代码扫描）",
        "DAST：动态应用安全测试（运行时扫描）",
        "SCA：软件成分分析（依赖漏洞检测）",
        "渗透测试：模拟真实攻击"
      ]
    },
    {
      "type": "comparison",
      "title": "SAST vs DAST vs SCA",
      "columns": [
        {
          "title": "SAST",
          "color": "from-blue-500 to-indigo-500",
          "items": [
            { "label": "时机", "description": "开发阶段" },
            { "label": "对象", "description": "源代码" },
            { "label": "优点", "description": "早期发现、覆盖全面" },
            { "label": "工具", "description": "SonarQube、Semgrep" }
          ]
        },
        {
          "title": "DAST",
          "color": "from-green-500 to-teal-500",
          "items": [
            { "label": "时机", "description": "测试/生产阶段" },
            { "label": "对象", "description": "运行中应用" },
            { "label": "优点", "description": "发现运行时问题" },
            { "label": "工具", "description": "OWASP ZAP、Burp" }
          ]
        },
        {
          "title": "SCA",
          "color": "from-purple-500 to-pink-500",
          "items": [
            { "label": "时机", "description": "构建阶段" },
            { "label": "对象", "description": "第三方依赖" },
            { "label": "优点", "description": "发现已知漏洞" },
            { "label": "工具", "description": "Snyk、Dependabot" }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "GitHub Actions 安全扫描",
      "language": "yaml",
      "code": "name: Security Scan\n\non:\n  push:\n    branches: [main]\n  pull_request:\n    branches: [main]\n\njobs:\n  # SAST - 代码扫描\n  sast:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Run Semgrep\n        uses: returntocorp/semgrep-action@v1\n        with:\n          config: p/security-audit\n          \n  # SCA - 依赖扫描\n  sca:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Run Snyk\n        uses: snyk/actions/node@master\n        env:\n          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}\n        with:\n          command: test\n          args: --severity-threshold=high\n          \n  # 容器扫描\n  container-scan:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Build image\n        run: docker build -t myapp:${{ github.sha }} .\n        \n      - name: Run Trivy\n        uses: aquasecurity/trivy-action@master\n        with:\n          image-ref: myapp:${{ github.sha }}\n          severity: 'CRITICAL,HIGH'\n          exit-code: '1'"
    },
    {
      "type": "codeBlock",
      "title": "常用扫描工具",
      "language": "bash",
      "code": "# SAST - Semgrep\nsemgrep scan --config auto .\n\n# SCA - npm audit\nnpm audit --audit-level=high\n\n# SCA - Snyk\nsnyk test\n\n# 容器扫描 - Trivy\ntrivy image myapp:latest\n\n# DAST - OWASP ZAP (CLI)\nzap-cli quick-scan https://example.com\n\n# 基础设施扫描 - Checkov\ncheckov -d ./terraform/"
    },
    {
      "type": "table",
      "title": "漏洞严重等级",
      "highlightFirst": true,
      "headers": ["等级", "CVSS", "修复时限", "示例"],
      "rows": [
        ["Critical", "9.0-10.0", "24小时", "RCE、未授权访问"],
        ["High", "7.0-8.9", "7天", "SQL注入、XSS"],
        ["Medium", "4.0-6.9", "30天", "信息泄露"],
        ["Low", "0.1-3.9", "90天", "最佳实践问题"]
      ]
    },
    {
      "type": "list",
      "title": "集成建议",
      "style": "check",
      "items": [
        { "label": "CI/CD 集成", "description": "每次提交自动扫描" },
        { "label": "阻断策略", "description": "Critical/High 漏洞阻止合并" },
        { "label": "定期全量扫描", "description": "每周对生产环境扫描" },
        { "label": "漏洞跟踪", "description": "与 JIRA/Issues 集成" }
      ]
    }
  ],
  "relatedTopics": ["DevSecOps", "CI/CD", "渗透测试"]
}
