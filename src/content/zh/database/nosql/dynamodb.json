{
  "meta": {
    "title": "DynamoDB",
    "description": "AWS DynamoDB 完全托管的 NoSQL 数据库服务",
    "order": 4,
    "tags": ["DynamoDB", "AWS", "NoSQL", "Serverless"]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "核心概念",
      "items": [
        "AWS 完全托管的 NoSQL 键值/文档数据库",
        "自动扩展，毫秒级延迟，支持海量数据",
        "Serverless 模式，按需付费",
        "内置备份、加密、全球表复制"
      ]
    },
    {
      "type": "cards",
      "title": "核心组件",
      "layout": "grid",
      "columns": 3,
      "items": [
        {
          "title": "Table",
          "badge": "表",
          "badgeColor": "blue",
          "points": [
            "数据容器",
            "无固定 Schema",
            "自动分区"
          ]
        },
        {
          "title": "Item",
          "badge": "项目",
          "badgeColor": "green",
          "points": [
            "类似行/文档",
            "属性集合",
            "最大 400KB"
          ]
        },
        {
          "title": "Attribute",
          "badge": "属性",
          "badgeColor": "purple",
          "points": [
            "键值对",
            "支持嵌套",
            "标量/集合/文档"
          ]
        },
        {
          "title": "Partition Key",
          "badge": "PK",
          "badgeColor": "red",
          "points": [
            "必须唯一",
            "决定分区",
            "哈希分布"
          ]
        },
        {
          "title": "Sort Key",
          "badge": "SK",
          "badgeColor": "amber",
          "points": [
            "可选",
            "范围查询",
            "复合主键"
          ]
        },
        {
          "title": "GSI / LSI",
          "badge": "索引",
          "badgeColor": "cyan",
          "points": [
            "全局二级索引",
            "本地二级索引",
            "灵活查询"
          ]
        }
      ]
    },
    {
      "type": "comparison",
      "title": "容量模式",
      "columns": [
        {
          "title": "按需模式",
          "color": "from-green-500 to-emerald-500",
          "items": [
            { "label": "计费", "description": "按请求数付费" },
            { "label": "适用", "description": "流量不可预测" },
            { "label": "扩展", "description": "自动扩展" }
          ]
        },
        {
          "title": "预置模式",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            { "label": "计费", "description": "预设 RCU/WCU" },
            { "label": "适用", "description": "流量可预测" },
            { "label": "成本", "description": "更低单价" }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "AWS CLI 操作",
      "language": "bash",
      "code": "# 创建表\naws dynamodb create-table \\\n  --table-name Users \\\n  --attribute-definitions \\\n    AttributeName=userId,AttributeType=S \\\n  --key-schema \\\n    AttributeName=userId,KeyType=HASH \\\n  --billing-mode PAY_PER_REQUEST\n\n# 写入数据\naws dynamodb put-item \\\n  --table-name Users \\\n  --item '{\"userId\": {\"S\": \"u001\"}, \"name\": {\"S\": \"Alice\"}, \"age\": {\"N\": \"28\"}}'\n\n# 查询数据\naws dynamodb get-item \\\n  --table-name Users \\\n  --key '{\"userId\": {\"S\": \"u001\"}}'"
    },
    {
      "type": "codeBlock",
      "title": "Python Boto3 示例",
      "language": "python",
      "code": "import boto3\nfrom boto3.dynamodb.conditions import Key, Attr\n\ndynamodb = boto3.resource('dynamodb')\ntable = dynamodb.Table('Orders')\n\n# 写入\ntable.put_item(Item={\n    'orderId': 'order-001',\n    'userId': 'user-001',\n    'amount': 99.99,\n    'status': 'pending'\n})\n\n# 查询 (需要 PK)\nresponse = table.query(\n    KeyConditionExpression=Key('userId').eq('user-001')\n)\n\n# 扫描 (全表，慎用)\nresponse = table.scan(\n    FilterExpression=Attr('status').eq('pending')\n)\n\n# 更新\ntable.update_item(\n    Key={'orderId': 'order-001'},\n    UpdateExpression='SET #s = :val',\n    ExpressionAttributeNames={'#s': 'status'},\n    ExpressionAttributeValues={':val': 'completed'}\n)"
    },
    {
      "type": "table",
      "title": "数据类型",
      "highlightFirst": true,
      "headers": ["类型", "代码", "示例"],
      "rows": [
        ["String", "S", "\"hello\""],
        ["Number", "N", "\"123.45\""],
        ["Binary", "B", "base64 编码"],
        ["Boolean", "BOOL", "true/false"],
        ["List", "L", "[{\"S\": \"a\"}, {\"N\": \"1\"}]"],
        ["Map", "M", "{\"name\": {\"S\": \"Alice\"}}"],
        ["String Set", "SS", "[\"a\", \"b\", \"c\"]"]
      ]
    },
    {
      "type": "flow",
      "title": "单表设计模式",
      "direction": "horizontal",
      "steps": [
        { "label": "识别访问模式", "description": "列出所有查询", "color": "bg-blue-500" },
        { "label": "设计主键", "description": "PK + SK 组合", "color": "bg-purple-500" },
        { "label": "添加 GSI", "description": "支持额外查询", "color": "bg-green-500" },
        { "label": "去规范化", "description": "数据冗余换性能", "color": "bg-orange-500" }
      ]
    },
    {
      "type": "list",
      "title": "最佳实践",
      "style": "check",
      "items": [
        { "label": "均匀分布 PK", "description": "避免热分区，使用高基数属性" },
        { "label": "单表设计", "description": "将多实体放入一个表，减少查询次数" },
        { "label": "使用 GSI 稀疏索引", "description": "只索引需要的项目" },
        { "label": "批量操作", "description": "BatchWriteItem/BatchGetItem 提高效率" },
        { "label": "TTL 自动过期", "description": "设置 TTL 自动清理过期数据" }
      ]
    }
  ],
  "relatedTopics": ["MongoDB", "Redis", "AWS", "Serverless"]
}
