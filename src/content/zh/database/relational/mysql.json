{
  "meta": {
    "title": "MySQL",
    "description": "MySQL 数据库核心概念、查询优化与高可用架构",
    "order": 1,
    "tags": ["MySQL", "SQL", "关系型数据库"]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "核心概念",
      "items": [
        "MySQL 是最流行的开源关系型数据库",
        "InnoDB 引擎支持事务和行锁",
        "B+Tree 索引结构，支持覆盖索引",
        "MVCC 多版本并发控制"
      ]
    },
    {
      "type": "cards",
      "title": "存储引擎",
      "layout": "grid",
      "columns": 2,
      "items": [
        {
          "title": "InnoDB",
          "badge": "推荐",
          "badgeColor": "green",
          "points": [
            "ACID 事务支持",
            "行级锁，高并发",
            "外键约束",
            "崩溃恢复"
          ]
        },
        {
          "title": "MyISAM",
          "badge": "旧版",
          "badgeColor": "gray",
          "points": [
            "不支持事务",
            "表级锁",
            "全文索引",
            "适合只读场景"
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "索引类型",
      "language": "sql",
      "code": "-- B+Tree 索引 (默认)\nCREATE INDEX idx_name ON users(name);\n\n-- 唯一索引\nCREATE UNIQUE INDEX idx_email ON users(email);\n\n-- 复合索引\nCREATE INDEX idx_name_age ON users(name, age);\n\n-- 全文索引\nCREATE FULLTEXT INDEX idx_content ON articles(content);\n\n-- 最左前缀原则\n-- 索引 (a, b, c)\nWHERE a = 1                  -- 使用索引\nWHERE a = 1 AND b = 2        -- 使用索引\nWHERE b = 2                  -- 不使用索引"
    },
    {
      "type": "comparison",
      "title": "事务隔离级别",
      "columns": [
        {
          "title": "READ UNCOMMITTED",
          "color": "from-red-500 to-orange-500",
          "items": [
            { "label": "问题", "description": "脏读" },
            { "label": "性能", "description": "最高" }
          ]
        },
        {
          "title": "READ COMMITTED",
          "color": "from-amber-500 to-yellow-500",
          "items": [
            { "label": "问题", "description": "不可重复读" },
            { "label": "性能", "description": "较高" }
          ]
        },
        {
          "title": "REPEATABLE READ",
          "color": "from-green-500 to-emerald-500",
          "items": [
            { "label": "问题", "description": "幻读" },
            { "label": "性能", "description": "默认级别" }
          ]
        },
        {
          "title": "SERIALIZABLE",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            { "label": "问题", "description": "无" },
            { "label": "性能", "description": "最低" }
          ]
        }
      ]
    },
    {
      "type": "table",
      "title": "锁类型",
      "highlightFirst": true,
      "headers": ["锁类型", "粒度", "并发性", "适用场景"],
      "rows": [
        ["共享锁 (S)", "行", "允许多读", "SELECT ... LOCK IN SHARE MODE"],
        ["排他锁 (X)", "行", "互斥", "SELECT ... FOR UPDATE"],
        ["间隙锁", "范围", "防止幻读", "REPEATABLE READ 级别"],
        ["表锁", "表", "低", "DDL 操作"]
      ]
    },
    {
      "type": "codeBlock",
      "title": "查询优化",
      "language": "sql",
      "code": "-- 分析执行计划\nEXPLAIN SELECT * FROM orders WHERE user_id = 1;\n\n-- 避免 SELECT *\nSELECT id, name, email FROM users;\n\n-- 避免在索引列上使用函数\n-- 错误: WHERE YEAR(created_at) = 2024\n-- 正确:\nWHERE created_at >= '2024-01-01' AND created_at < '2025-01-01';\n\n-- 批量插入\nINSERT INTO users (name, email) VALUES\n('user1', 'u1@test.com'),\n('user2', 'u2@test.com');"
    },
    {
      "type": "flow",
      "title": "主从复制",
      "direction": "horizontal",
      "steps": [
        { "label": "主库写入", "description": "Binlog", "color": "bg-blue-500" },
        { "label": "传输日志", "description": "IO Thread", "color": "bg-purple-500" },
        { "label": "从库接收", "description": "Relay Log", "color": "bg-cyan-500" },
        { "label": "重放应用", "description": "SQL Thread", "color": "bg-green-500" }
      ]
    },
    {
      "type": "list",
      "title": "高可用方案",
      "style": "check",
      "items": [
        { "label": "主从复制", "description": "异步/半同步/组复制" },
        { "label": "读写分离", "description": "主写从读，ProxySQL/MaxScale" },
        { "label": "分库分表", "description": "ShardingSphere、MyCat、Vitess" },
        { "label": "MGR", "description": "MySQL Group Replication 多主" }
      ]
    }
  ],
  "relatedTopics": ["PostgreSQL", "索引优化", "分库分表"]
}
