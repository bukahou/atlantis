{
  "slug": "tcp-ip",
  "meta": {
    "title": "TCP/IP プロトコル基礎",
    "description": "ネットワーク通信の核心プロトコルスタックを理解する",
    "order": 1,
    "tags": [
      "network",
      "tcp",
      "ip",
      "protocol"
    ]
  },
  "content": "<h1>TCP/IP プロトコル基礎</h1>\n<h2>ネットワーク階層モデル</h2>\n<h3>OSI 7層 vs TCP/IP 4層</h3>\n<pre><code>OSI モデル            TCP/IP モデル        プロトコル例\n┌─────────────┐      ┌─────────────┐\n│ アプリケーション層│      │             │       HTTP, FTP, DNS\n├─────────────┤      │アプリケーション層│       SMTP, SSH, HTTPS\n│ プレゼンテーション層│      │             │\n├─────────────┤      ├─────────────┤\n│  セッション層  │      │             │\n├─────────────┤      ├─────────────┤\n│  トランスポート層 │      │トランスポート層│       TCP, UDP\n├─────────────┤      ├─────────────┤\n│  ネットワーク層  │      │ネットワーク層 │       IP, ICMP, ARP\n├─────────────┤      ├─────────────┤\n│ データリンク層  │      │             │       Ethernet, Wi-Fi\n├─────────────┤      │ネットワークインターフェース層│\n│   物理層     │      │             │\n└─────────────┘      └─────────────┘\n</code></pre>\n<h2>IP プロトコル</h2>\n<h3>IPv4 アドレス</h3>\n<pre><code>32 ビットアドレス、ドット区切り10進数表記\n\n192.168.1.100\n\n┌────────┬────────┬────────┬────────┐\n│   192  │   168  │    1   │   100  │\n├────────┴────────┴────────┴────────┤\n│  11000000.10101000.00000001.01100100\n└───────────────────────────────────┘\n</code></pre>\n<h3>IP アドレス分類</h3>\n<table>\n<thead>\n<tr>\n<th>クラス</th>\n<th>範囲</th>\n<th>デフォルトマスク</th>\n<th>用途</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>A</td>\n<td>1.0.0.0 - 126.255.255.255</td>\n<td>255.0.0.0</td>\n<td>大規模ネットワーク</td>\n</tr>\n<tr>\n<td>B</td>\n<td>128.0.0.0 - 191.255.255.255</td>\n<td>255.255.0.0</td>\n<td>中規模ネットワーク</td>\n</tr>\n<tr>\n<td>C</td>\n<td>192.0.0.0 - 223.255.255.255</td>\n<td>255.255.255.0</td>\n<td>小規模ネットワーク</td>\n</tr>\n</tbody>\n</table>\n<h3>プライベートアドレス</h3>\n<pre><code>10.0.0.0    - 10.255.255.255   (クラス A)\n172.16.0.0  - 172.31.255.255   (クラス B)\n192.168.0.0 - 192.168.255.255  (クラス C)\n</code></pre>\n<h3>サブネット分割</h3>\n<pre><code class=\"language-bash\"># CIDR 表記\n192.168.1.0/24\n\n# サブネットマスク\n255.255.255.0\n\n# 計算\nネットワークアドレス: 192.168.1.0\nブロードキャストアドレス: 192.168.1.255\n使用可能ホスト: 192.168.1.1 - 192.168.1.254 (254 個)\n</code></pre>\n<h2>TCP プロトコル</h2>\n<h3>TCP の特徴</h3>\n<ul>\n<li><strong>コネクション指向</strong>: 通信前に接続を確立</li>\n<li><strong>信頼性のある伝送</strong>: データの完全性と順序を保証</li>\n<li><strong>フロー制御</strong>: 送信速度を調整</li>\n<li><strong>輻輳制御</strong>: ネットワーク状況に適応</li>\n</ul>\n<h3>3ウェイハンドシェイク</h3>\n<pre><code>クライアント                      サーバー\n   │                              │\n   │  ─────── SYN (seq=x) ──────> │  1. クライアントが接続開始\n   │                              │\n   │  &#x3C;── SYN+ACK (seq=y,ack=x+1) │  2. サーバーが確認と同期\n   │                              │\n   │  ─────── ACK (ack=y+1) ────> │  3. クライアントが確認\n   │                              │\n   │        接続確立               │\n</code></pre>\n<h3>4ウェイハンドシェイク</h3>\n<pre><code>クライアント                      サーバー\n   │                              │\n   │  ─────── FIN (seq=u) ──────> │  1. クライアントが切断要求\n   │                              │\n   │  &#x3C;────── ACK (ack=u+1) ───── │  2. サーバーが確認\n   │                              │\n   │  &#x3C;────── FIN (seq=v) ─────── │  3. サーバーが切断要求\n   │                              │\n   │  ─────── ACK (ack=v+1) ────> │  4. クライアントが確認\n   │                              │\n   │        接続終了               │\n</code></pre>\n<h3>TCP ヘッダー</h3>\n<pre><code> 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n├─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤\n│         送信元ポート (16 bit)    │       宛先ポート (16 bit)     │\n├───────────────────────────────┴───────────────────────────────┤\n│                      シーケンス番号 (32 bit)                    │\n├───────────────────────────────────────────────────────────────┤\n│                        確認応答番号 (32 bit)                    │\n├───────┬───────┬─┬─┬─┬─┬─┬─┬───────────────────────────────────┤\n│ヘッダ長│ 予約  │U│A│P│R│S│F│       ウィンドウサイズ (16 bit)   │\n├───────┴───────┴─┴─┴─┴─┴─┴─┴───────────────────────────────────┤\n│        チェックサム (16 bit)     │      緊急ポインタ (16 bit)    │\n└───────────────────────────────┴───────────────────────────────┘\n</code></pre>\n<h3>よく使うポート</h3>\n<table>\n<thead>\n<tr>\n<th>ポート</th>\n<th>プロトコル</th>\n<th>サービス</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>20/21</td>\n<td>TCP</td>\n<td>FTP</td>\n</tr>\n<tr>\n<td>22</td>\n<td>TCP</td>\n<td>SSH</td>\n</tr>\n<tr>\n<td>23</td>\n<td>TCP</td>\n<td>Telnet</td>\n</tr>\n<tr>\n<td>25</td>\n<td>TCP</td>\n<td>SMTP</td>\n</tr>\n<tr>\n<td>53</td>\n<td>TCP/UDP</td>\n<td>DNS</td>\n</tr>\n<tr>\n<td>80</td>\n<td>TCP</td>\n<td>HTTP</td>\n</tr>\n<tr>\n<td>443</td>\n<td>TCP</td>\n<td>HTTPS</td>\n</tr>\n<tr>\n<td>3306</td>\n<td>TCP</td>\n<td>MySQL</td>\n</tr>\n<tr>\n<td>6379</td>\n<td>TCP</td>\n<td>Redis</td>\n</tr>\n</tbody>\n</table>\n<h2>UDP プロトコル</h2>\n<h3>UDP vs TCP</h3>\n<table>\n<thead>\n<tr>\n<th>特性</th>\n<th>TCP</th>\n<th>UDP</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>接続</td>\n<td>コネクション指向</td>\n<td>コネクションレス</td>\n</tr>\n<tr>\n<td>信頼性</td>\n<td>信頼性あり</td>\n<td>信頼性なし</td>\n</tr>\n<tr>\n<td>順序</td>\n<td>順序保証</td>\n<td>順序保証なし</td>\n</tr>\n<tr>\n<td>速度</td>\n<td>遅め</td>\n<td>速い</td>\n</tr>\n<tr>\n<td>用途</td>\n<td>ファイル転送、Web</td>\n<td>動画ストリーミング、ゲーム</td>\n</tr>\n</tbody>\n</table>\n<h3>UDP ヘッダー</h3>\n<pre><code> 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n├─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┤\n│         送信元ポート (16 bit)    │       宛先ポート (16 bit)     │\n├───────────────────────────────┼───────────────────────────────┤\n│          長さ (16 bit)          │      チェックサム (16 bit)    │\n└───────────────────────────────┴───────────────────────────────┘\n</code></pre>\n<h2>ネットワーク診断ツール</h2>\n<h3>ping</h3>\n<pre><code class=\"language-bash\"># 疎通確認\nping 8.8.8.8\nping -c 4 google.com    # 4 パケット送信\n</code></pre>\n<h3>traceroute</h3>\n<pre><code class=\"language-bash\"># ルート経路を追跡\ntraceroute google.com\ntracepath google.com\n</code></pre>\n<h3>netstat</h3>\n<pre><code class=\"language-bash\"># ネットワーク接続を確認\nnetstat -tuln          # TCP/UDP リスニングポート\nnetstat -anp           # すべての接続とプロセス\n</code></pre>\n<h3>ss</h3>\n<pre><code class=\"language-bash\"># 現代的な netstat 代替\nss -tuln               # リスニングポート\nss -s                  # 統計情報\n</code></pre>\n<h3>tcpdump</h3>\n<pre><code class=\"language-bash\"># パケットキャプチャ\ntcpdump -i eth0                    # インターフェース指定\ntcpdump -i eth0 port 80            # ポート指定\ntcpdump -i eth0 host 192.168.1.1   # ホスト指定\ntcpdump -w capture.pcap            # ファイルに保存\n</code></pre>\n<h3>curl</h3>\n<pre><code class=\"language-bash\"># HTTP リクエストテスト\ncurl http://example.com\ncurl -I http://example.com         # ヘッダーのみ\ncurl -X POST -d \"data\" http://api  # POST リクエスト\n</code></pre>\n<h2>まとめ</h2>\n<p>TCP/IP はインターネットの基盤です：</p>\n<ol>\n<li><strong>IP</strong> はアドレッシングとルーティングを担当</li>\n<li><strong>TCP</strong> は信頼性のあるエンドツーエンド伝送を提供</li>\n<li><strong>UDP</strong> は高速だが信頼性のない伝送を提供</li>\n<li>階層モデルの理解はネットワーク問題の切り分けに役立つ</li>\n</ol>\n<p>よく使う診断ツールをマスターすれば、ネットワーク障害を素早く特定できます。</p>\n"
}