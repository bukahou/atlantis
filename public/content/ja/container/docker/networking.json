{
  "slug": "networking",
  "meta": {
    "title": "Docker ネットワーク",
    "description": "Docker ネットワークモード、コンテナ通信とネットワーク設定",
    "order": 2,
    "tags": [
      "Docker",
      "ネットワーク",
      "コンテナ通信"
    ]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "コア概念",
      "items": [
        "Docker は複数のネットワークドライバモードを提供",
        "コンテナはネットワーク経由でサービスディスカバリと通信を実現",
        "カスタムネットワークでコンテナ分離を実現",
        "DNS がコンテナ名を自動解決"
      ]
    },
    {
      "type": "cards",
      "title": "ネットワークドライバ",
      "layout": "grid",
      "columns": 2,
      "items": [
        {
          "title": "bridge",
          "badge": "デフォルト",
          "badgeColor": "blue",
          "points": [
            "デフォルトのネットワークドライバ",
            "コンテナ間は IP で通信",
            "NAT 方式で外部アクセス",
            "ポートマッピングでサービスを公開"
          ]
        },
        {
          "title": "host",
          "badge": "高性能",
          "badgeColor": "green",
          "points": [
            "ホストのネットワークスタックを共有",
            "ネットワーク分離なし",
            "最高のネットワーク性能",
            "ホストポートを直接使用"
          ]
        },
        {
          "title": "overlay",
          "badge": "クロスホスト",
          "badgeColor": "purple",
          "points": [
            "マルチホストコンテナ通信",
            "Swarm/K8s クラスタで使用",
            "VXLAN カプセル化",
            "クロスノードサービスディスカバリ"
          ]
        },
        {
          "title": "none",
          "badge": "分離",
          "badgeColor": "gray",
          "points": [
            "ネットワークを無効化",
            "完全なネットワーク分離",
            "カスタムネットワークシナリオ",
            "セキュリティが重要なアプリケーション"
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "ネットワーク操作コマンド",
      "language": "bash",
      "code": "# カスタムネットワークを作成\ndocker network create --driver bridge my-network\n\n# ネットワーク一覧を表示\ndocker network ls\n\n# ネットワーク詳細を表示\ndocker network inspect my-network\n\n# ネットワークに参加してコンテナを実行\ndocker run -d --name app --network my-network nginx\n\n# 実行中のコンテナをネットワークに接続\ndocker network connect my-network container-name\n\n# ネットワークからコンテナを切断\ndocker network disconnect my-network container-name\n\n# ネットワークを削除\ndocker network rm my-network"
    },
    {
      "type": "codeBlock",
      "title": "Docker Compose ネットワーク設定",
      "language": "yaml",
      "code": "version: '3.8'\n\nservices:\n  web:\n    image: nginx\n    networks:\n      - frontend\n      - backend\n    ports:\n      - \"80:80\"\n\n  api:\n    image: node:18\n    networks:\n      - backend\n    expose:\n      - \"3000\"\n\n  db:\n    image: postgres:14\n    networks:\n      - backend\n    # backend ネットワークでのみアクセス可能\n\nnetworks:\n  frontend:\n    driver: bridge\n  backend:\n    driver: bridge\n    internal: true  # 外部アクセスを禁止"
    },
    {
      "type": "comparison",
      "title": "ポートマッピング vs expose",
      "columns": [
        {
          "title": "ports",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            {
              "label": "用途",
              "description": "ホストポートにマッピング"
            },
            {
              "label": "アクセス",
              "description": "外部からアクセス可能"
            },
            {
              "label": "構文",
              "description": "\"8080:80\""
            }
          ]
        },
        {
          "title": "expose",
          "color": "from-green-500 to-emerald-500",
          "items": [
            {
              "label": "用途",
              "description": "コンテナ間通信"
            },
            {
              "label": "アクセス",
              "description": "内部ネットワークのみ"
            },
            {
              "label": "構文",
              "description": "\"3000\""
            }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "コンテナ DNS とサービスディスカバリ",
      "language": "bash",
      "code": "# カスタムネットワークでは、コンテナ名が DNS 名になる\ndocker network create app-net\n\n# データベースを起動\ndocker run -d --name db --network app-net postgres:14\n\n# アプリケーションがコンテナ名でデータベースにアクセス\ndocker run -d --name app --network app-net \\\n  -e DATABASE_URL=\"postgresql://db:5432/mydb\" \\\n  my-app\n\n# app コンテナ内から db に直接 ping 可能\ndocker exec app ping db\n\n# エイリアスを使用\ndocker run -d --name db --network app-net \\\n  --network-alias database \\\n  postgres:14"
    },
    {
      "type": "table",
      "title": "ネットワークドライバ比較",
      "highlightFirst": true,
      "headers": [
        "ドライバ",
        "分離性",
        "性能",
        "適用シナリオ"
      ],
      "rows": [
        [
          "bridge",
          "コンテナ分離",
          "良好",
          "単一ホストマルチコンテナ"
        ],
        [
          "host",
          "分離なし",
          "最高",
          "性能重視アプリケーション"
        ],
        [
          "overlay",
          "クロスホスト分離",
          "良好",
          "Swarm/K8s クラスタ"
        ],
        [
          "macvlan",
          "物理ネットワーク",
          "良好",
          "物理 IP が必要"
        ],
        [
          "none",
          "完全分離",
          "-",
          "セキュリティ/カスタム"
        ]
      ]
    },
    {
      "type": "list",
      "title": "ベストプラクティス",
      "style": "check",
      "items": [
        {
          "label": "カスタムネットワークを使用",
          "description": "デフォルト bridge を避け、DNS 解決を取得"
        },
        {
          "label": "ネットワーク分離",
          "description": "異なるサービスグループに異なるネットワークを使用"
        },
        {
          "label": "internal ネットワーク",
          "description": "データベースなど内部サービスは外部アクセスを禁止"
        },
        {
          "label": "host モードを避ける",
          "description": "性能要件が極めて高い場合を除く"
        }
      ]
    }
  ],
  "relatedTopics": [
    "Docker 基礎",
    "Kubernetes",
    "マイクロサービス"
  ]
}