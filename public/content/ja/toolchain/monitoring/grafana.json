{
  "slug": "grafana",
  "meta": {
    "title": "Grafana",
    "description": "Grafana 可視化ダッシュボード、データソース設定とアラート",
    "order": 2,
    "tags": [
      "Grafana",
      "可視化",
      "ダッシュボード",
      "監視"
    ]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "コアコンセプト",
      "items": [
        "Grafana はオープンソースの可視化と分析プラットフォーム",
        "複数データソースをサポート：Prometheus/InfluxDB/ES",
        "豊富なグラフタイプとパネル",
        "Dashboard as Code をサポート"
      ]
    },
    {
      "type": "cards",
      "title": "コア機能",
      "layout": "grid",
      "columns": 3,
      "items": [
        {
          "title": "Dashboard",
          "badge": "ダッシュボード",
          "badgeColor": "blue",
          "points": [
            "パネルレイアウト",
            "変数テンプレート",
            "JSON エクスポート"
          ]
        },
        {
          "title": "Panel",
          "badge": "パネル",
          "badgeColor": "green",
          "points": [
            "Graph/Stat/Table",
            "Heatmap/Gauge",
            "可視化設定"
          ]
        },
        {
          "title": "Alerting",
          "badge": "アラート",
          "badgeColor": "red",
          "points": [
            "マルチチャンネル通知",
            "アラートルール",
            "サイレンス管理"
          ]
        }
      ]
    },
    {
      "type": "comparison",
      "title": "データソース比較",
      "columns": [
        {
          "title": "Prometheus",
          "color": "from-orange-500 to-red-500",
          "items": [
            {
              "label": "タイプ",
              "description": "時系列データベース"
            },
            {
              "label": "クエリ",
              "description": "PromQL"
            },
            {
              "label": "適用",
              "description": "メトリクス監視"
            }
          ]
        },
        {
          "title": "Elasticsearch",
          "color": "from-green-500 to-teal-500",
          "items": [
            {
              "label": "タイプ",
              "description": "検索エンジン"
            },
            {
              "label": "クエリ",
              "description": "Lucene/KQL"
            },
            {
              "label": "適用",
              "description": "ログ分析"
            }
          ]
        },
        {
          "title": "InfluxDB",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            {
              "label": "タイプ",
              "description": "時系列データベース"
            },
            {
              "label": "クエリ",
              "description": "Flux/InfluxQL"
            },
            {
              "label": "適用",
              "description": "IoT/メトリクス"
            }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "Dashboard JSON 設定",
      "language": "json",
      "code": "{\n  \"dashboard\": {\n    \"title\": \"Application Metrics\",\n    \"tags\": [\"application\"],\n    \"templating\": {\n      \"list\": [\n        {\n          \"name\": \"namespace\",\n          \"type\": \"query\",\n          \"datasource\": \"Prometheus\",\n          \"query\": \"label_values(namespace)\"\n        }\n      ]\n    },\n    \"panels\": [\n      {\n        \"title\": \"Request Rate\",\n        \"type\": \"graph\",\n        \"targets\": [\n          {\n            \"expr\": \"sum(rate(http_requests_total{namespace=\\\"$namespace\\\"}[5m]))\",\n            \"legendFormat\": \"{{method}}\"\n          }\n        ]\n      }\n    ]\n  }\n}"
    },
    {
      "type": "codeBlock",
      "title": "Provisioning 設定",
      "language": "yaml",
      "code": "# datasources/prometheus.yaml\napiVersion: 1\ndatasources:\n  - name: Prometheus\n    type: prometheus\n    access: proxy\n    url: http://prometheus:9090\n    isDefault: true\n    editable: false\n\n# dashboards/default.yaml\napiVersion: 1\nproviders:\n  - name: 'default'\n    orgId: 1\n    folder: ''\n    type: file\n    disableDeletion: false\n    updateIntervalSeconds: 10\n    options:\n      path: /var/lib/grafana/dashboards"
    },
    {
      "type": "table",
      "title": "よく使うパネルタイプ",
      "highlightFirst": true,
      "headers": [
        "パネル",
        "用途",
        "典型シナリオ"
      ],
      "rows": [
        [
          "Time series",
          "時系列グラフ",
          "トレンド分析"
        ],
        [
          "Stat",
          "単一値統計",
          "主要メトリクス"
        ],
        [
          "Gauge",
          "ゲージ",
          "使用率"
        ],
        [
          "Table",
          "テーブル",
          "詳細データ"
        ],
        [
          "Heatmap",
          "ヒートマップ",
          "分布分析"
        ],
        [
          "Logs",
          "ログパネル",
          "ログ閲覧"
        ]
      ]
    },
    {
      "type": "codeBlock",
      "title": "変数テンプレート",
      "language": "promql",
      "code": "# ラベル値変数\nlabel_values(up, job)\n\n# 変数を使ったクエリ\nsum(rate(http_requests_total{job=\"$job\"}[5m])) by (status)\n\n# 複数値変数 (正規表現マッチ)\nhttp_requests_total{instance=~\"$instance\"}\n\n# 全選択サポート\nhttp_requests_total{namespace=~\"${namespace:regex}\"}"
    },
    {
      "type": "list",
      "title": "ベストプラクティス",
      "style": "check",
      "items": [
        {
          "label": "Dashboard as Code",
          "description": "JSON/Jsonnet でダッシュボードを管理"
        },
        {
          "label": "変数再利用",
          "description": "テンプレート変数で動的フィルタリングを実現"
        },
        {
          "label": "適切なレイアウト",
          "description": "機能別にグループ化、重要メトリクス優先"
        },
        {
          "label": "統一スタイル",
          "description": "チームで一貫した色と命名を使用"
        }
      ]
    }
  ],
  "relatedTopics": [
    "Prometheus",
    "Elasticsearch",
    "監視アラート"
  ]
}