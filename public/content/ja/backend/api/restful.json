{
  "slug": "restful",
  "meta": {
    "title": "RESTful API 設計",
    "description": "RESTful API 設計原則、ベストプラクティスと規約",
    "order": 1,
    "tags": [
      "api",
      "rest",
      "http",
      "backend"
    ]
  },
  "content": "<h1>RESTful API 設計</h1>\n<h2>REST 概要</h2>\n<p>REST (Representational State Transfer) は、Web サービスを作成するための制約と原則を定義したソフトウェアアーキテクチャスタイルです。</p>\n<pre><code>REST コア原則\n├── 統一インターフェース - 標準化されたリソース操作\n├── ステートレス - リクエストに全情報を含む\n├── キャッシュ可能 - レスポンスをキャッシュ可能\n├── 階層システム - クライアントはサーバー構成を知らない\n└── オンデマンドコード - オプションのコードダウンロード\n</code></pre>\n<h2>リソース設計</h2>\n<h3>URL 設計</h3>\n<pre><code># リソース命名規約\nGET    /users              # ユーザー一覧取得\nGET    /users/123          # 単一ユーザー取得\nPOST   /users              # ユーザー作成\nPUT    /users/123          # ユーザー更新\nPATCH  /users/123          # 部分更新\nDELETE /users/123          # ユーザー削除\n\n# ネストリソース\nGET    /users/123/posts          # ユーザーの記事一覧\nGET    /users/123/posts/456      # ユーザーの特定記事\nPOST   /users/123/posts          # ユーザーの記事作成\n\n# 避けるべき設計\nGET    /getUsers            # ❌ 動詞\nGET    /user/list           # ❌ 動詞\nPOST   /createUser          # ❌ 動詞\nGET    /users/get/123       # ❌ 冗長\n</code></pre>\n<h3>命名規約</h3>\n<pre><code># 複数形名詞を使用\n/users          ✓\n/user           ✗\n\n# 小文字とハイフン\n/user-profiles  ✓\n/userProfiles   ✗\n/user_profiles  ✗\n\n# リソース階層は 3 層以内\n/users/123/posts/456/comments     ✓\n/users/123/posts/456/comments/789/replies  ✗ (深すぎる)\n\n# クエリパラメータでフィルタ\n/posts?author=123&#x26;status=published  ✓\n/posts/author/123/status/published  ✗\n</code></pre>\n<h2>HTTP メソッド</h2>\n<h3>標準メソッド</h3>\n<pre><code>メソッド  冪等性   安全性   用途\n────────────────────────────────────\nGET       ○      ○      リソース取得\nPOST      ✗      ✗      リソース作成\nPUT       ○      ✗      完全更新\nPATCH     ✗      ✗      部分更新\nDELETE    ○      ✗      リソース削除\nHEAD      ○      ○      メタ情報取得\nOPTIONS   ○      ○      対応メソッド取得\n</code></pre>\n<h3>メソッド使用例</h3>\n<pre><code class=\"language-http\"># GET - リソース取得\nGET /api/v1/users/123 HTTP/1.1\nHost: api.example.com\n\n# POST - リソース作成\nPOST /api/v1/users HTTP/1.1\nContent-Type: application/json\n\n{\n  \"name\": \"Alice\",\n  \"email\": \"alice@example.com\"\n}\n\n# PUT - 完全更新\nPUT /api/v1/users/123 HTTP/1.1\nContent-Type: application/json\n\n{\n  \"name\": \"Alice Smith\",\n  \"email\": \"alice.smith@example.com\",\n  \"age\": 30\n}\n\n# PATCH - 部分更新\nPATCH /api/v1/users/123 HTTP/1.1\nContent-Type: application/json\n\n{\n  \"name\": \"Alice Smith\"\n}\n\n# DELETE - リソース削除\nDELETE /api/v1/users/123 HTTP/1.1\n</code></pre>\n<h2>ステータスコード</h2>\n<h3>よく使うステータスコード</h3>\n<pre><code>2xx 成功\n────────────────────────────\n200 OK                 リクエスト成功\n201 Created            リソース作成成功\n204 No Content         成功、返却内容なし\n\n3xx リダイレクト\n────────────────────────────\n301 Moved Permanently  永久リダイレクト\n304 Not Modified       リソース未変更\n\n4xx クライアントエラー\n────────────────────────────\n400 Bad Request        リクエスト形式エラー\n401 Unauthorized       未認証\n403 Forbidden          権限なし\n404 Not Found          リソース存在しない\n405 Method Not Allowed メソッド不許可\n409 Conflict           リソース競合\n422 Unprocessable      バリデーション失敗\n429 Too Many Requests  リクエスト過多\n\n5xx サーバーエラー\n────────────────────────────\n500 Internal Error     サーバーエラー\n502 Bad Gateway        ゲートウェイエラー\n503 Service Unavailable サービス利用不可\n504 Gateway Timeout    ゲートウェイタイムアウト\n</code></pre>\n<h3>ステータスコード選択</h3>\n<pre><code class=\"language-json\">// 201 Created - 作成成功\nPOST /users\nResponse: 201 Created\nLocation: /users/123\n{\n  \"id\": 123,\n  \"name\": \"Alice\"\n}\n\n// 204 No Content - 削除成功\nDELETE /users/123\nResponse: 204 No Content\n\n// 400 Bad Request - リクエスト形式エラー\n{\n  \"error\": \"Bad Request\",\n  \"message\": \"Invalid JSON format\"\n}\n\n// 422 Unprocessable Entity - バリデーション失敗\n{\n  \"error\": \"Validation Error\",\n  \"details\": [\n    {\"field\": \"email\", \"message\": \"Invalid email format\"}\n  ]\n}\n</code></pre>\n<h2>リクエストとレスポンス</h2>\n<h3>リクエストヘッダー</h3>\n<pre><code class=\"language-http\">Content-Type: application/json\nAccept: application/json\nAuthorization: Bearer &#x3C;token>\nAccept-Language: ja-JP\nX-Request-ID: uuid-string\n</code></pre>\n<h3>レスポンス形式</h3>\n<pre><code class=\"language-json\">// 単一リソース\n{\n  \"id\": 123,\n  \"name\": \"Alice\",\n  \"email\": \"alice@example.com\",\n  \"createdAt\": \"2024-01-15T10:30:00Z\",\n  \"updatedAt\": \"2024-01-15T10:30:00Z\"\n}\n\n// リソース一覧\n{\n  \"data\": [\n    {\"id\": 1, \"name\": \"Alice\"},\n    {\"id\": 2, \"name\": \"Bob\"}\n  ],\n  \"meta\": {\n    \"total\": 100,\n    \"page\": 1,\n    \"perPage\": 20,\n    \"totalPages\": 5\n  }\n}\n\n// エラーレスポンス\n{\n  \"error\": {\n    \"code\": \"VALIDATION_ERROR\",\n    \"message\": \"Validation failed\",\n    \"details\": [\n      {\"field\": \"email\", \"message\": \"Invalid format\"}\n    ]\n  }\n}\n</code></pre>\n<h2>ページネーションとフィルタ</h2>\n<h3>ページネーション</h3>\n<pre><code class=\"language-http\"># オフセットページネーション\nGET /users?page=2&#x26;per_page=20\n\n# カーソルページネーション (大規模データ推奨)\nGET /users?cursor=abc123&#x26;limit=20\n\n# レスポンス\n{\n  \"data\": [...],\n  \"meta\": {\n    \"total\": 1000,\n    \"page\": 2,\n    \"perPage\": 20\n  },\n  \"links\": {\n    \"first\": \"/users?page=1\",\n    \"prev\": \"/users?page=1\",\n    \"next\": \"/users?page=3\",\n    \"last\": \"/users?page=50\"\n  }\n}\n</code></pre>\n<h3>フィルタとソート</h3>\n<pre><code class=\"language-http\"># フィルタ\nGET /users?status=active&#x26;role=admin\nGET /posts?created_after=2024-01-01\n\n# ソート\nGET /users?sort=name           # 昇順\nGET /users?sort=-created_at    # 降順\nGET /users?sort=name,-age      # 複数フィールド\n\n# フィールド選択\nGET /users?fields=id,name,email\n\n# 検索\nGET /users?q=alice\nGET /posts?search=keyword\n</code></pre>\n<h2>バージョン管理</h2>\n<pre><code class=\"language-http\"># URL パスバージョン (推奨)\nGET /api/v1/users\nGET /api/v2/users\n\n# リクエストヘッダーバージョン\nGET /api/users\nAccept: application/vnd.api+json; version=1\n\n# クエリパラメータバージョン\nGET /api/users?version=1\n</code></pre>\n<h2>認証とセキュリティ</h2>\n<pre><code class=\"language-http\"># Bearer Token\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIs...\n\n# API Key\nX-API-Key: your-api-key\n\n# Basic Auth\nAuthorization: Basic base64(username:password)\n</code></pre>\n<h3>セキュリティベストプラクティス</h3>\n<pre><code>1. 常に HTTPS を使用\n2. すべての入力を検証\n3. レート制限を実装\n4. 適切な CORS ポリシー\n5. URL に機密情報を含めない\n6. リクエストログと監査を実装\n</code></pre>\n<h2>HATEOAS</h2>\n<pre><code class=\"language-json\">// Hypermedia as the Engine of Application State\n{\n  \"id\": 123,\n  \"name\": \"Alice\",\n  \"status\": \"active\",\n  \"_links\": {\n    \"self\": {\"href\": \"/users/123\"},\n    \"posts\": {\"href\": \"/users/123/posts\"},\n    \"deactivate\": {\n      \"href\": \"/users/123/deactivate\",\n      \"method\": \"POST\"\n    }\n  }\n}\n</code></pre>\n<h2>まとめ</h2>\n<p>RESTful API 設計のポイント：</p>\n<ol>\n<li><strong>リソース指向</strong> - URL はリソース、HTTP メソッドは操作</li>\n<li><strong>正確なステータスコード</strong> - 結果を正確に反映</li>\n<li><strong>一貫性</strong> - 統一された命名とレスポンス形式</li>\n<li><strong>バージョン管理</strong> - API の進化をサポート</li>\n<li><strong>セキュリティ</strong> - HTTPS、認証、検証</li>\n</ol>\n"
}