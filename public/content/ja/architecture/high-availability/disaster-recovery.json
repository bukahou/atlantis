{
  "slug": "disaster-recovery",
  "meta": {
    "title": "災害復旧",
    "description": "マルチリージョンアクティブ、データバックアップと復旧戦略",
    "order": 3,
    "tags": [
      "高可用性",
      "災害復旧",
      "バックアップ"
    ]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "コアコンセプト",
      "items": [
        "RPO (Recovery Point Objective)：許容可能なデータ損失量",
        "RTO (Recovery Time Objective)：許容可能な復旧時間",
        "災害復旧レベル：同一都市、異なる都市、2サイト3センター",
        "バックアップ戦略：フル、増分、差分バックアップ"
      ]
    },
    {
      "type": "cards",
      "title": "災害復旧レベル",
      "layout": "grid",
      "columns": 3,
      "items": [
        {
          "title": "同一都市デュアルアクティブ",
          "badge": "Level 1",
          "badgeColor": "blue",
          "points": [
            "同一都市のDC",
            "低遅延同期",
            "単一DCの障害を防止"
          ]
        },
        {
          "title": "異なる都市DR",
          "badge": "Level 2",
          "badgeColor": "green",
          "points": [
            "異なる都市のバックアップセンター",
            "非同期複製",
            "地域災害を防止"
          ]
        },
        {
          "title": "2サイト3センター",
          "badge": "Level 3",
          "badgeColor": "purple",
          "points": [
            "同一都市+異なる都市",
            "リアルタイム+非同期",
            "金融グレード"
          ]
        }
      ]
    },
    {
      "type": "table",
      "title": "RPO/RTO とソリューション",
      "highlightFirst": true,
      "headers": [
        "RPO",
        "RTO",
        "ソリューション",
        "コスト"
      ],
      "rows": [
        [
          "0",
          "<1分",
          "同期複製+ホットスタンバイ",
          "非常に高い"
        ],
        [
          "<1分",
          "<5分",
          "非同期複製+ウォームスタンバイ",
          "高い"
        ],
        [
          "<1時間",
          "<30分",
          "定期バックアップ+コールドスタンバイ",
          "中"
        ],
        [
          "<24時間",
          "<4時間",
          "毎日バックアップ+オフライン復旧",
          "低い"
        ]
      ]
    },
    {
      "type": "codeBlock",
      "title": "MySQL バックアップ戦略",
      "language": "bash",
      "code": "# フルバックアップ（毎週）\nmysqldump --single-transaction --master-data=2 \\\n    --all-databases > full_backup_$(date +%Y%m%d).sql\n\n# 増分バックアップ（毎日）- binlog使用\nmysqlbinlog --start-datetime=\"2024-01-01 00:00:00\" \\\n    --stop-datetime=\"2024-01-02 00:00:00\" \\\n    mysql-bin.* > incremental_$(date +%Y%m%d).sql\n\n# 物理バックアップ（Percona XtraBackup）\nxtrabackup --backup --target-dir=/backup/full\nxtrabackup --backup --target-dir=/backup/inc1 \\\n    --incremental-basedir=/backup/full\n\n# 復旧手順\nxtrabackup --prepare --target-dir=/backup/full\nxtrabackup --prepare --target-dir=/backup/full \\\n    --incremental-dir=/backup/inc1\nxtrabackup --copy-back --target-dir=/backup/full"
    },
    {
      "type": "codeBlock",
      "title": "マルチリージョンアクティブアーキテクチャ",
      "language": "text",
      "code": "                    ┌─────────────────┐\n                    │   グローバル    │\n                    │   ルーティング  │\n                    │   (GeoDNS)      │\n                    └────────┬────────┘\n                             │\n         ┌───────────────────┼───────────────────┐\n         ▼                   ▼                   ▼\n┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐\n│    東京DC       │ │    大阪DC       │ │    シンガDC     │\n├─────────────────┤ ├─────────────────┤ ├─────────────────┤\n│  アプリ (Active)│ │  アプリ (Active)│ │  アプリ (Active)│\n│  キャッシュ     │ │  キャッシュ     │ │  キャッシュ     │\n│  DB (マスター)  │ │  DB (スレーブ)  │ │  DB (スレーブ)  │\n└────────┬────────┘ └────────┬────────┘ └────────┬────────┘\n         │                   │                   │\n         └───────────────────┴───────────────────┘\n                    データ同期チャネル\n\nユニット化設計：\n- ユーザーIDでシャーディングし固定DCにルーティング\n- 同一DCで処理完結、クロスDC呼び出しを削減\n- 必要なデータのみクロスDC同期"
    },
    {
      "type": "comparison",
      "title": "コールドスタンバイ vs ホットスタンバイ",
      "columns": [
        {
          "title": "コールドスタンバイ",
          "color": "from-gray-500 to-slate-500",
          "items": [
            {
              "label": "状態",
              "description": "待機システムはオフ"
            },
            {
              "label": "RTO",
              "description": "時間単位"
            },
            {
              "label": "コスト",
              "description": "低い（ストレージのみ）"
            },
            {
              "label": "用途",
              "description": "非コアシステム"
            }
          ]
        },
        {
          "title": "ホットスタンバイ",
          "color": "from-red-500 to-orange-500",
          "items": [
            {
              "label": "状態",
              "description": "リアルタイム稼働"
            },
            {
              "label": "RTO",
              "description": "分単位"
            },
            {
              "label": "コスト",
              "description": "高い（2倍のリソース）"
            },
            {
              "label": "用途",
              "description": "コアビジネス"
            }
          ]
        }
      ]
    },
    {
      "type": "list",
      "title": "災害復旧訓練",
      "style": "check",
      "items": [
        {
          "label": "定期訓練",
          "description": "少なくとも四半期に1回のフル訓練"
        },
        {
          "label": "自動化スクリプト",
          "description": "切替操作を自動化し人的エラーを削減"
        },
        {
          "label": "監視アラート",
          "description": "同期遅延、バックアップ状態をリアルタイム監視"
        },
        {
          "label": "ドキュメント更新",
          "description": "復旧手順書を常に最新に維持"
        }
      ]
    }
  ],
  "relatedTopics": [
    "データバックアップ",
    "マルチリージョンアクティブ",
    "Chaos Engineering"
  ]
}