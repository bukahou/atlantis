{
  "slug": "dynamodb",
  "meta": {
    "title": "DynamoDB",
    "description": "AWS DynamoDB フルマネージド NoSQL データベースサービス",
    "order": 4,
    "tags": [
      "DynamoDB",
      "AWS",
      "NoSQL",
      "Serverless"
    ]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "コア概念",
      "items": [
        "AWS フルマネージド NoSQL キーバリュー/ドキュメントデータベース",
        "自動スケーリング、ミリ秒レイテンシ、大規模データ対応",
        "サーバーレスモード、従量課金",
        "組み込みバックアップ、暗号化、グローバルテーブル"
      ]
    },
    {
      "type": "cards",
      "title": "コアコンポーネント",
      "layout": "grid",
      "columns": 3,
      "items": [
        {
          "title": "Table",
          "badge": "テーブル",
          "badgeColor": "blue",
          "points": [
            "データコンテナ",
            "スキーマレス",
            "自動パーティション"
          ]
        },
        {
          "title": "Item",
          "badge": "アイテム",
          "badgeColor": "green",
          "points": [
            "行/ドキュメント相当",
            "属性の集合",
            "最大 400KB"
          ]
        },
        {
          "title": "Attribute",
          "badge": "属性",
          "badgeColor": "purple",
          "points": [
            "キーバリューペア",
            "ネスト対応",
            "スカラー/セット/ドキュメント"
          ]
        },
        {
          "title": "Partition Key",
          "badge": "PK",
          "badgeColor": "red",
          "points": [
            "一意である必要",
            "パーティション決定",
            "ハッシュ分散"
          ]
        },
        {
          "title": "Sort Key",
          "badge": "SK",
          "badgeColor": "amber",
          "points": [
            "オプション",
            "範囲クエリ",
            "複合主キー"
          ]
        },
        {
          "title": "GSI / LSI",
          "badge": "インデックス",
          "badgeColor": "cyan",
          "points": [
            "グローバルセカンダリ",
            "ローカルセカンダリ",
            "柔軟なクエリ"
          ]
        }
      ]
    },
    {
      "type": "comparison",
      "title": "キャパシティモード",
      "columns": [
        {
          "title": "オンデマンド",
          "color": "from-green-500 to-emerald-500",
          "items": [
            {
              "label": "課金",
              "description": "リクエスト数課金"
            },
            {
              "label": "適用",
              "description": "予測困難なトラフィック"
            },
            {
              "label": "スケール",
              "description": "自動スケーリング"
            }
          ]
        },
        {
          "title": "プロビジョンド",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            {
              "label": "課金",
              "description": "RCU/WCU 事前設定"
            },
            {
              "label": "適用",
              "description": "予測可能なトラフィック"
            },
            {
              "label": "コスト",
              "description": "単価が安い"
            }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "AWS CLI 操作",
      "language": "bash",
      "code": "# テーブル作成\naws dynamodb create-table \\\n  --table-name Users \\\n  --attribute-definitions \\\n    AttributeName=userId,AttributeType=S \\\n  --key-schema \\\n    AttributeName=userId,KeyType=HASH \\\n  --billing-mode PAY_PER_REQUEST\n\n# データ書き込み\naws dynamodb put-item \\\n  --table-name Users \\\n  --item '{\"userId\": {\"S\": \"u001\"}, \"name\": {\"S\": \"Alice\"}, \"age\": {\"N\": \"28\"}}'\n\n# データ取得\naws dynamodb get-item \\\n  --table-name Users \\\n  --key '{\"userId\": {\"S\": \"u001\"}}'"
    },
    {
      "type": "codeBlock",
      "title": "Python Boto3 サンプル",
      "language": "python",
      "code": "import boto3\nfrom boto3.dynamodb.conditions import Key, Attr\n\ndynamodb = boto3.resource('dynamodb')\ntable = dynamodb.Table('Orders')\n\n# 書き込み\ntable.put_item(Item={\n    'orderId': 'order-001',\n    'userId': 'user-001',\n    'amount': 99.99,\n    'status': 'pending'\n})\n\n# クエリ (PK 必須)\nresponse = table.query(\n    KeyConditionExpression=Key('userId').eq('user-001')\n)\n\n# スキャン (全テーブル、注意)\nresponse = table.scan(\n    FilterExpression=Attr('status').eq('pending')\n)\n\n# 更新\ntable.update_item(\n    Key={'orderId': 'order-001'},\n    UpdateExpression='SET #s = :val',\n    ExpressionAttributeNames={'#s': 'status'},\n    ExpressionAttributeValues={':val': 'completed'}\n)"
    },
    {
      "type": "table",
      "title": "データ型",
      "highlightFirst": true,
      "headers": [
        "型",
        "コード",
        "例"
      ],
      "rows": [
        [
          "String",
          "S",
          "\"hello\""
        ],
        [
          "Number",
          "N",
          "\"123.45\""
        ],
        [
          "Binary",
          "B",
          "base64 エンコード"
        ],
        [
          "Boolean",
          "BOOL",
          "true/false"
        ],
        [
          "List",
          "L",
          "[{\"S\": \"a\"}, {\"N\": \"1\"}]"
        ],
        [
          "Map",
          "M",
          "{\"name\": {\"S\": \"Alice\"}}"
        ],
        [
          "String Set",
          "SS",
          "[\"a\", \"b\", \"c\"]"
        ]
      ]
    },
    {
      "type": "flow",
      "title": "シングルテーブル設計",
      "direction": "horizontal",
      "steps": [
        {
          "label": "アクセスパターン特定",
          "description": "全クエリをリスト化",
          "color": "bg-blue-500"
        },
        {
          "label": "主キー設計",
          "description": "PK + SK の組み合わせ",
          "color": "bg-purple-500"
        },
        {
          "label": "GSI 追加",
          "description": "追加クエリ対応",
          "color": "bg-green-500"
        },
        {
          "label": "非正規化",
          "description": "冗長性で性能向上",
          "color": "bg-orange-500"
        }
      ]
    },
    {
      "type": "list",
      "title": "ベストプラクティス",
      "style": "check",
      "items": [
        {
          "label": "PK の均等分散",
          "description": "ホットパーティション回避、高カーディナリティ属性使用"
        },
        {
          "label": "シングルテーブル設計",
          "description": "複数エンティティを1テーブルに、クエリ削減"
        },
        {
          "label": "GSI スパースインデックス",
          "description": "必要なアイテムのみインデックス"
        },
        {
          "label": "バッチ操作",
          "description": "BatchWriteItem/BatchGetItem で効率化"
        },
        {
          "label": "TTL 自動削除",
          "description": "TTL 設定で期限切れデータ自動削除"
        }
      ]
    }
  ],
  "relatedTopics": [
    "MongoDB",
    "Redis",
    "AWS",
    "Serverless"
  ]
}