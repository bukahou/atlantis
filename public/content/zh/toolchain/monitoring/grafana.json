{
  "slug": "grafana",
  "meta": {
    "title": "Grafana",
    "description": "Grafana 可视化仪表盘、数据源配置与告警",
    "order": 2,
    "tags": [
      "Grafana",
      "可视化",
      "仪表盘",
      "监控"
    ]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "核心概念",
      "items": [
        "Grafana 是开源的可视化和分析平台",
        "支持多种数据源：Prometheus/InfluxDB/ES",
        "丰富的图表类型和面板",
        "Dashboard as Code 支持"
      ]
    },
    {
      "type": "cards",
      "title": "核心功能",
      "layout": "grid",
      "columns": 3,
      "items": [
        {
          "title": "Dashboard",
          "badge": "仪表盘",
          "badgeColor": "blue",
          "points": [
            "面板布局",
            "变量模板",
            "JSON 导出"
          ]
        },
        {
          "title": "Panel",
          "badge": "面板",
          "badgeColor": "green",
          "points": [
            "Graph/Stat/Table",
            "Heatmap/Gauge",
            "可视化配置"
          ]
        },
        {
          "title": "Alerting",
          "badge": "告警",
          "badgeColor": "red",
          "points": [
            "多通道通知",
            "告警规则",
            "静默管理"
          ]
        }
      ]
    },
    {
      "type": "comparison",
      "title": "数据源对比",
      "columns": [
        {
          "title": "Prometheus",
          "color": "from-orange-500 to-red-500",
          "items": [
            {
              "label": "类型",
              "description": "时序数据库"
            },
            {
              "label": "查询",
              "description": "PromQL"
            },
            {
              "label": "适用",
              "description": "指标监控"
            }
          ]
        },
        {
          "title": "Elasticsearch",
          "color": "from-green-500 to-teal-500",
          "items": [
            {
              "label": "类型",
              "description": "搜索引擎"
            },
            {
              "label": "查询",
              "description": "Lucene/KQL"
            },
            {
              "label": "适用",
              "description": "日志分析"
            }
          ]
        },
        {
          "title": "InfluxDB",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            {
              "label": "类型",
              "description": "时序数据库"
            },
            {
              "label": "查询",
              "description": "Flux/InfluxQL"
            },
            {
              "label": "适用",
              "description": "IoT/指标"
            }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "Dashboard JSON 配置",
      "language": "json",
      "code": "{\n  \"dashboard\": {\n    \"title\": \"Application Metrics\",\n    \"tags\": [\"application\"],\n    \"templating\": {\n      \"list\": [\n        {\n          \"name\": \"namespace\",\n          \"type\": \"query\",\n          \"datasource\": \"Prometheus\",\n          \"query\": \"label_values(namespace)\"\n        }\n      ]\n    },\n    \"panels\": [\n      {\n        \"title\": \"Request Rate\",\n        \"type\": \"graph\",\n        \"targets\": [\n          {\n            \"expr\": \"sum(rate(http_requests_total{namespace=\\\"$namespace\\\"}[5m]))\",\n            \"legendFormat\": \"{{method}}\"\n          }\n        ]\n      }\n    ]\n  }\n}"
    },
    {
      "type": "codeBlock",
      "title": "Provisioning 配置",
      "language": "yaml",
      "code": "# datasources/prometheus.yaml\napiVersion: 1\ndatasources:\n  - name: Prometheus\n    type: prometheus\n    access: proxy\n    url: http://prometheus:9090\n    isDefault: true\n    editable: false\n\n# dashboards/default.yaml\napiVersion: 1\nproviders:\n  - name: 'default'\n    orgId: 1\n    folder: ''\n    type: file\n    disableDeletion: false\n    updateIntervalSeconds: 10\n    options:\n      path: /var/lib/grafana/dashboards"
    },
    {
      "type": "table",
      "title": "常用面板类型",
      "highlightFirst": true,
      "headers": [
        "面板",
        "用途",
        "典型场景"
      ],
      "rows": [
        [
          "Time series",
          "时间序列图",
          "趋势分析"
        ],
        [
          "Stat",
          "单值统计",
          "关键指标"
        ],
        [
          "Gauge",
          "仪表盘",
          "使用率"
        ],
        [
          "Table",
          "表格",
          "详细数据"
        ],
        [
          "Heatmap",
          "热力图",
          "分布分析"
        ],
        [
          "Logs",
          "日志面板",
          "日志查看"
        ]
      ]
    },
    {
      "type": "codeBlock",
      "title": "变量模板",
      "language": "promql",
      "code": "# 标签值变量\nlabel_values(up, job)\n\n# 使用变量的查询\nsum(rate(http_requests_total{job=\"$job\"}[5m])) by (status)\n\n# 多值变量 (正则匹配)\nhttp_requests_total{instance=~\"$instance\"}\n\n# 全选支持\nhttp_requests_total{namespace=~\"${namespace:regex}\"}"
    },
    {
      "type": "list",
      "title": "最佳实践",
      "style": "check",
      "items": [
        {
          "label": "Dashboard as Code",
          "description": "使用 JSON/Jsonnet 管理仪表盘"
        },
        {
          "label": "变量复用",
          "description": "使用模板变量实现动态过滤"
        },
        {
          "label": "合理布局",
          "description": "按功能分组，重要指标优先"
        },
        {
          "label": "统一风格",
          "description": "团队使用一致的颜色和命名"
        }
      ]
    }
  ],
  "relatedTopics": [
    "Prometheus",
    "Elasticsearch",
    "监控告警"
  ]
}