{
  "slug": "workflow",
  "meta": {
    "title": "Git 工作流",
    "description": "Git 分支策略与团队协作工作流",
    "order": 1,
    "tags": [
      "git",
      "workflow",
      "collaboration"
    ]
  },
  "content": "<h1>Git 工作流</h1>\n<h2>基础概念</h2>\n<h3>工作区域</h3>\n<pre><code>┌─────────────────────────────────────────────────────────┐\n│  工作目录          暂存区            本地仓库           │\n│  (Working)        (Staging)        (Repository)        │\n│                                                         │\n│     文件   ──add──>  暂存   ──commit──>  提交历史       │\n│                                                         │\n└─────────────────────────────────────────────────────────┘\n</code></pre>\n<h3>常用命令</h3>\n<pre><code class=\"language-bash\"># 查看状态\ngit status\n\n# 添加到暂存区\ngit add file.txt\ngit add .              # 添加所有文件\n\n# 提交\ngit commit -m \"feat: add new feature\"\n\n# 查看历史\ngit log\ngit log --oneline --graph\n</code></pre>\n<h2>分支管理</h2>\n<h3>分支操作</h3>\n<pre><code class=\"language-bash\"># 查看分支\ngit branch            # 本地分支\ngit branch -r         # 远程分支\ngit branch -a         # 所有分支\n\n# 创建分支\ngit branch feature/login\n\n# 切换分支\ngit checkout feature/login\ngit switch feature/login      # Git 2.23+\n\n# 创建并切换\ngit checkout -b feature/login\ngit switch -c feature/login   # Git 2.23+\n\n# 删除分支\ngit branch -d feature/login   # 已合并的分支\ngit branch -D feature/login   # 强制删除\n</code></pre>\n<h3>合并与变基</h3>\n<pre><code class=\"language-bash\"># 合并分支\ngit checkout main\ngit merge feature/login\n\n# 变基 (保持线性历史)\ngit checkout feature/login\ngit rebase main\n\n# 交互式变基 (整理提交)\ngit rebase -i HEAD~3\n</code></pre>\n<h2>Git Flow 工作流</h2>\n<h3>分支模型</h3>\n<pre><code>main        ●────────────────●────────────────●\n             \\              /                /\nrelease       \\    ●───●───●                /\n               \\  /                        /\ndevelop    ●────●────●────●────●────●────●\n            \\       /      \\      /\nfeature      ●─●─●─●        ●─●─●\n</code></pre>\n<h3>分支说明</h3>\n<table>\n<thead>\n<tr>\n<th>分支</th>\n<th>用途</th>\n<th>生命周期</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>main</code></td>\n<td>生产代码</td>\n<td>永久</td>\n</tr>\n<tr>\n<td><code>develop</code></td>\n<td>开发主线</td>\n<td>永久</td>\n</tr>\n<tr>\n<td><code>feature/*</code></td>\n<td>新功能开发</td>\n<td>临时</td>\n</tr>\n<tr>\n<td><code>release/*</code></td>\n<td>版本发布准备</td>\n<td>临时</td>\n</tr>\n<tr>\n<td><code>hotfix/*</code></td>\n<td>紧急修复</td>\n<td>临时</td>\n</tr>\n</tbody>\n</table>\n<h3>工作流程</h3>\n<pre><code class=\"language-bash\"># 1. 开始新功能\ngit checkout develop\ngit checkout -b feature/user-auth\n\n# 2. 开发完成后合并\ngit checkout develop\ngit merge --no-ff feature/user-auth\ngit branch -d feature/user-auth\n\n# 3. 准备发布\ngit checkout -b release/v1.0.0 develop\n# ... 测试和修复 ...\ngit checkout main\ngit merge --no-ff release/v1.0.0\ngit tag -a v1.0.0 -m \"Release v1.0.0\"\n\n# 4. 紧急修复\ngit checkout -b hotfix/critical-bug main\n# ... 修复 ...\ngit checkout main\ngit merge --no-ff hotfix/critical-bug\ngit checkout develop\ngit merge --no-ff hotfix/critical-bug\n</code></pre>\n<h2>GitHub Flow</h2>\n<p>更简单的工作流，适合持续部署。</p>\n<pre><code>main     ●────●────●────●────●\n          \\  /      \\  /\nfeature    ●─●        ●─●\n</code></pre>\n<h3>流程</h3>\n<ol>\n<li>从 <code>main</code> 创建功能分支</li>\n<li>开发并提交</li>\n<li>创建 Pull Request</li>\n<li>代码审查</li>\n<li>合并到 <code>main</code></li>\n<li>自动部署</li>\n</ol>\n<pre><code class=\"language-bash\"># 1. 创建分支\ngit checkout -b feature/add-login\n\n# 2. 开发提交\ngit add .\ngit commit -m \"feat: implement login page\"\n\n# 3. 推送并创建 PR\ngit push -u origin feature/add-login\n# 在 GitHub 上创建 Pull Request\n\n# 4. 合并后删除分支\ngit checkout main\ngit pull\ngit branch -d feature/add-login\n</code></pre>\n<h2>提交规范</h2>\n<h3>Conventional Commits</h3>\n<pre><code>&#x3C;type>(&#x3C;scope>): &#x3C;subject>\n\n&#x3C;body>\n\n&#x3C;footer>\n</code></pre>\n<h3>Type 类型</h3>\n<table>\n<thead>\n<tr>\n<th>Type</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>feat</code></td>\n<td>新功能</td>\n</tr>\n<tr>\n<td><code>fix</code></td>\n<td>Bug 修复</td>\n</tr>\n<tr>\n<td><code>docs</code></td>\n<td>文档更新</td>\n</tr>\n<tr>\n<td><code>style</code></td>\n<td>代码格式 (不影响功能)</td>\n</tr>\n<tr>\n<td><code>refactor</code></td>\n<td>重构</td>\n</tr>\n<tr>\n<td><code>perf</code></td>\n<td>性能优化</td>\n</tr>\n<tr>\n<td><code>test</code></td>\n<td>测试相关</td>\n</tr>\n<tr>\n<td><code>chore</code></td>\n<td>构建/工具变更</td>\n</tr>\n</tbody>\n</table>\n<h3>示例</h3>\n<pre><code class=\"language-bash\">git commit -m \"feat(auth): add OAuth2 login support\"\ngit commit -m \"fix(api): handle null response correctly\"\ngit commit -m \"docs: update API documentation\"\n</code></pre>\n<h2>远程协作</h2>\n<h3>远程仓库</h3>\n<pre><code class=\"language-bash\"># 添加远程\ngit remote add origin git@github.com:user/repo.git\n\n# 查看远程\ngit remote -v\n\n# 推送\ngit push origin main\ngit push -u origin feature/login  # 设置上游分支\n\n# 拉取\ngit pull origin main\ngit fetch origin                   # 仅获取，不合并\n</code></pre>\n<h3>处理冲突</h3>\n<pre><code class=\"language-bash\"># 1. 拉取最新代码\ngit pull origin main\n\n# 2. 如果有冲突，手动解决\n# 编辑冲突文件，保留需要的代码\n\n# 3. 标记为已解决\ngit add conflicted-file.txt\n\n# 4. 继续合并/变基\ngit commit -m \"resolve merge conflict\"\n# 或\ngit rebase --continue\n</code></pre>\n<h2>实用技巧</h2>\n<h3>暂存工作</h3>\n<pre><code class=\"language-bash\"># 暂存当前修改\ngit stash\n\n# 查看暂存列表\ngit stash list\n\n# 恢复暂存\ngit stash pop          # 恢复并删除\ngit stash apply        # 恢复但保留\n\n# 清除暂存\ngit stash drop\ngit stash clear\n</code></pre>\n<h3>撤销操作</h3>\n<pre><code class=\"language-bash\"># 撤销工作区修改\ngit checkout -- file.txt\ngit restore file.txt        # Git 2.23+\n\n# 撤销暂存\ngit reset HEAD file.txt\ngit restore --staged file.txt\n\n# 撤销提交 (保留修改)\ngit reset --soft HEAD~1\n\n# 撤销提交 (丢弃修改)\ngit reset --hard HEAD~1\n\n# 修改最后一次提交\ngit commit --amend\n</code></pre>\n<h3>查看差异</h3>\n<pre><code class=\"language-bash\"># 工作区与暂存区\ngit diff\n\n# 暂存区与最新提交\ngit diff --staged\n\n# 两个提交之间\ngit diff commit1 commit2\n\n# 两个分支之间\ngit diff main..feature/login\n</code></pre>\n<h2>总结</h2>\n<p>选择合适的工作流：</p>\n<table>\n<thead>\n<tr>\n<th>场景</th>\n<th>推荐工作流</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>小团队/快速迭代</td>\n<td>GitHub Flow</td>\n</tr>\n<tr>\n<td>版本发布/多环境</td>\n<td>Git Flow</td>\n</tr>\n<tr>\n<td>个人项目</td>\n<td>主干开发</td>\n</tr>\n</tbody>\n</table>\n<p>关键原则：</p>\n<ol>\n<li><strong>频繁提交</strong>：小步提交，便于追踪</li>\n<li><strong>清晰的提交信息</strong>：遵循规范</li>\n<li><strong>分支隔离</strong>：功能独立开发</li>\n<li><strong>代码审查</strong>：通过 PR 保证质量</li>\n</ol>\n"
}