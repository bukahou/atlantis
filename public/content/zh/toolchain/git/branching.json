{
  "slug": "branching",
  "meta": {
    "title": "分支策略",
    "description": "Git 分支管理策略与实践",
    "order": 2,
    "tags": [
      "Git",
      "分支",
      "策略",
      "协作"
    ]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "核心概念",
      "items": [
        "分支策略决定代码管理和发布流程",
        "不同团队规模适用不同策略",
        "分支命名规范提升协作效率",
        "保护分支确保主干代码质量"
      ]
    },
    {
      "type": "cards",
      "title": "主流分支策略",
      "layout": "grid",
      "columns": 2,
      "items": [
        {
          "title": "Git Flow",
          "badge": "经典",
          "badgeColor": "blue",
          "points": [
            "main：生产环境代码",
            "develop：开发主干",
            "feature/*：功能分支",
            "release/*：发布准备",
            "hotfix/*：紧急修复"
          ]
        },
        {
          "title": "GitHub Flow",
          "badge": "简洁",
          "badgeColor": "green",
          "points": [
            "main：始终可部署",
            "feature/*：所有修改",
            "PR 审核后合并",
            "合并即部署"
          ]
        },
        {
          "title": "GitLab Flow",
          "badge": "混合",
          "badgeColor": "orange",
          "points": [
            "main：开发主干",
            "环境分支：pre-production/production",
            "功能分支 + MR",
            "逐级合并发布"
          ]
        },
        {
          "title": "Trunk Based",
          "badge": "敏捷",
          "badgeColor": "purple",
          "points": [
            "main：唯一长期分支",
            "短生命周期分支",
            "频繁集成（每日）",
            "Feature Flag 控制"
          ]
        }
      ]
    },
    {
      "type": "flow",
      "title": "Git Flow 流程",
      "direction": "horizontal",
      "steps": [
        {
          "label": "feature",
          "description": "功能开发",
          "color": "bg-blue-500"
        },
        {
          "label": "develop",
          "description": "集成测试",
          "color": "bg-cyan-500"
        },
        {
          "label": "release",
          "description": "发布准备",
          "color": "bg-purple-500"
        },
        {
          "label": "main",
          "description": "生产发布",
          "color": "bg-green-500"
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "Git Flow 操作",
      "language": "bash",
      "code": "# 初始化 Git Flow\ngit flow init\n\n# 功能分支\ngit flow feature start login\n# 开发完成后...\ngit flow feature finish login\n\n# 发布分支\ngit flow release start 1.0.0\n# 测试完成后...\ngit flow release finish 1.0.0\n\n# 紧急修复\ngit flow hotfix start fix-bug\ngit flow hotfix finish fix-bug\n\n# 手动操作（不使用 git-flow 工具）\ngit checkout -b feature/login develop\ngit checkout develop && git merge --no-ff feature/login\ngit branch -d feature/login"
    },
    {
      "type": "codeBlock",
      "title": "GitHub Flow 操作",
      "language": "bash",
      "code": "# 1. 从 main 创建分支\ngit checkout main\ngit pull origin main\ngit checkout -b feature/new-feature\n\n# 2. 开发并提交\ngit add .\ngit commit -m \"feat: add new feature\"\n\n# 3. 推送到远程\ngit push -u origin feature/new-feature\n\n# 4. 创建 Pull Request\ngh pr create --title \"Add new feature\" --body \"Description...\"\n\n# 5. Code Review 后合并\ngh pr merge --squash\n\n# 6. 删除分支\ngit branch -d feature/new-feature\ngit push origin --delete feature/new-feature"
    },
    {
      "type": "table",
      "title": "分支命名规范",
      "highlightFirst": true,
      "headers": [
        "类型",
        "格式",
        "示例"
      ],
      "rows": [
        [
          "功能",
          "feature/<name>",
          "feature/user-login"
        ],
        [
          "修复",
          "fix/<issue>",
          "fix/memory-leak"
        ],
        [
          "热修复",
          "hotfix/<version>",
          "hotfix/1.0.1"
        ],
        [
          "发布",
          "release/<version>",
          "release/2.0.0"
        ],
        [
          "重构",
          "refactor/<scope>",
          "refactor/auth-module"
        ]
      ]
    },
    {
      "type": "comparison",
      "title": "策略选择",
      "columns": [
        {
          "title": "Git Flow",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            {
              "label": "适用",
              "description": "版本发布产品"
            },
            {
              "label": "团队",
              "description": "中大型团队"
            },
            {
              "label": "发布",
              "description": "计划性发布"
            },
            {
              "label": "复杂度",
              "description": "较高"
            }
          ]
        },
        {
          "title": "GitHub Flow",
          "color": "from-green-500 to-emerald-500",
          "items": [
            {
              "label": "适用",
              "description": "SaaS/持续部署"
            },
            {
              "label": "团队",
              "description": "小型敏捷团队"
            },
            {
              "label": "发布",
              "description": "持续发布"
            },
            {
              "label": "复杂度",
              "description": "简单"
            }
          ]
        },
        {
          "title": "Trunk Based",
          "color": "from-purple-500 to-pink-500",
          "items": [
            {
              "label": "适用",
              "description": "大型项目/微服务"
            },
            {
              "label": "团队",
              "description": "成熟工程团队"
            },
            {
              "label": "发布",
              "description": "Feature Flag"
            },
            {
              "label": "复杂度",
              "description": "中等"
            }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "分支保护规则",
      "language": "yaml",
      "code": "# GitHub Branch Protection Rules\n\nmain:\n  required_pull_request_reviews:\n    required_approving_review_count: 2\n    dismiss_stale_reviews: true\n  required_status_checks:\n    strict: true\n    contexts:\n      - \"ci/test\"\n      - \"ci/lint\"\n  enforce_admins: true\n  restrictions:\n    users: []\n    teams: [\"release-managers\"]\n\ndevelop:\n  required_pull_request_reviews:\n    required_approving_review_count: 1\n  required_status_checks:\n    contexts:\n      - \"ci/test\""
    },
    {
      "type": "list",
      "title": "最佳实践",
      "style": "check",
      "items": [
        {
          "label": "保护主分支",
          "description": "禁止直接推送，强制 PR 审核"
        },
        {
          "label": "分支命名规范",
          "description": "统一前缀，便于识别和管理"
        },
        {
          "label": "及时删除",
          "description": "合并后删除功能分支"
        },
        {
          "label": "Squash 合并",
          "description": "保持主干历史清晰"
        },
        {
          "label": "定期同步",
          "description": "功能分支及时 rebase 主干"
        }
      ]
    }
  ],
  "relatedTopics": [
    "Git 工作流",
    "CI/CD",
    "团队协作"
  ]
}