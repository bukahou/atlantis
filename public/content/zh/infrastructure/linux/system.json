{
  "slug": "system",
  "meta": {
    "title": "Linux 系统管理",
    "description": "Linux 系统管理核心知识与常用操作",
    "order": 2,
    "tags": [
      "linux",
      "system",
      "admin"
    ]
  },
  "content": "<h1>Linux 系统管理</h1>\n<h2>用户与权限</h2>\n<h3>用户管理</h3>\n<pre><code class=\"language-bash\"># 添加用户\nuseradd -m -s /bin/bash username\nuseradd -m -G sudo,docker username  # 指定附加组\n\n# 设置密码\npasswd username\n\n# 修改用户\nusermod -aG docker username   # 添加到组\nusermod -s /bin/zsh username  # 修改 shell\n\n# 删除用户\nuserdel username\nuserdel -r username           # 同时删除主目录\n</code></pre>\n<h3>组管理</h3>\n<pre><code class=\"language-bash\"># 创建组\ngroupadd developers\n\n# 查看组\ngroups username\ncat /etc/group\n\n# 删除组\ngroupdel developers\n</code></pre>\n<h3>文件权限</h3>\n<pre><code>-rwxr-xr-- 1 user group 1024 Jan 1 00:00 file.txt\n│└┬┘└┬┘└┬┘\n│ │  │  └── 其他用户: r-- (读)\n│ │  └───── 组: r-x (读+执行)\n│ └──────── 所有者: rwx (读+写+执行)\n└────────── 文件类型: - 普通文件, d 目录, l 链接\n</code></pre>\n<h3>权限操作</h3>\n<pre><code class=\"language-bash\"># 数字模式\nchmod 755 file.txt    # rwxr-xr-x\nchmod 644 file.txt    # rw-r--r--\n\n# 符号模式\nchmod u+x file.txt    # 所有者添加执行\nchmod g-w file.txt    # 组移除写入\nchmod o=r file.txt    # 其他用户只读\nchmod a+r file.txt    # 所有人添加读取\n\n# 递归修改\nchmod -R 755 directory/\n\n# 修改所有者\nchown user:group file.txt\nchown -R user:group directory/\n</code></pre>\n<h3>特殊权限</h3>\n<pre><code class=\"language-bash\"># SUID (4): 以文件所有者身份执行\nchmod u+s /usr/bin/passwd\nchmod 4755 executable\n\n# SGID (2): 以文件所属组身份执行\nchmod g+s directory/\nchmod 2755 directory/\n\n# Sticky Bit (1): 只有所有者能删除\nchmod +t /tmp\nchmod 1777 /tmp\n</code></pre>\n<h2>进程管理</h2>\n<h3>查看进程</h3>\n<pre><code class=\"language-bash\"># 常用 ps 命令\nps aux                 # 所有进程详情\nps -ef                 # 完整格式\nps -u username         # 指定用户进程\n\n# top 实时监控\ntop\nhtop                   # 增强版 (需安装)\n\n# 按资源排序\nps aux --sort=-%mem    # 内存排序\nps aux --sort=-%cpu    # CPU 排序\n</code></pre>\n<h3>进程控制</h3>\n<pre><code class=\"language-bash\"># 发送信号\nkill PID               # 默认 SIGTERM (15)\nkill -9 PID            # SIGKILL 强制终止\nkill -HUP PID          # SIGHUP 重载配置\n\n# 按名称终止\npkill nginx\nkillall nginx\n\n# 后台运行\ncommand &#x26;              # 后台执行\nnohup command &#x26;        # 忽略挂断信号\ndisown %1              # 从作业列表移除\n\n# 作业控制\njobs                   # 查看作业\nfg %1                  # 前台运行\nbg %1                  # 后台运行\nCtrl+Z                 # 暂停当前进程\n</code></pre>\n<h2>服务管理 (systemd)</h2>\n<h3>基本操作</h3>\n<pre><code class=\"language-bash\"># 服务状态\nsystemctl status nginx\nsystemctl is-active nginx\nsystemctl is-enabled nginx\n\n# 启停服务\nsystemctl start nginx\nsystemctl stop nginx\nsystemctl restart nginx\nsystemctl reload nginx    # 重载配置\n\n# 开机自启\nsystemctl enable nginx\nsystemctl disable nginx\n</code></pre>\n<h3>查看日志</h3>\n<pre><code class=\"language-bash\"># 查看服务日志\njournalctl -u nginx\njournalctl -u nginx -f        # 持续输出\njournalctl -u nginx --since today\njournalctl -u nginx -n 100    # 最后 100 行\n</code></pre>\n<h3>服务单元文件</h3>\n<pre><code class=\"language-ini\"># /etc/systemd/system/myapp.service\n\n[Unit]\nDescription=My Application\nAfter=network.target\n\n[Service]\nType=simple\nUser=appuser\nWorkingDirectory=/opt/myapp\nExecStart=/opt/myapp/bin/start.sh\nExecStop=/opt/myapp/bin/stop.sh\nRestart=on-failure\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<pre><code class=\"language-bash\"># 重载配置\nsystemctl daemon-reload\n</code></pre>\n<h2>磁盘管理</h2>\n<h3>查看磁盘</h3>\n<pre><code class=\"language-bash\"># 磁盘使用\ndf -h                  # 文件系统使用率\ndf -i                  # inode 使用率\n\n# 目录大小\ndu -sh /var/log        # 单个目录\ndu -sh /*              # 根目录各子目录\ndu -h --max-depth=1    # 一级子目录\n\n# 查看块设备\nlsblk\nfdisk -l\n</code></pre>\n<h3>挂载操作</h3>\n<pre><code class=\"language-bash\"># 挂载\nmount /dev/sdb1 /mnt/data\nmount -t nfs server:/share /mnt/nfs\n\n# 卸载\numount /mnt/data\numount -l /mnt/data    # 延迟卸载\n\n# 查看挂载\nmount | grep sdb\ncat /etc/mtab\n</code></pre>\n<h3>永久挂载 (/etc/fstab)</h3>\n<pre><code># &#x3C;设备>        &#x3C;挂载点>    &#x3C;类型>  &#x3C;选项>          &#x3C;dump> &#x3C;pass>\n/dev/sdb1      /mnt/data   ext4    defaults        0      2\nUUID=xxx-xxx   /mnt/backup ext4    defaults,noatime 0     2\n</code></pre>\n<h2>网络配置</h2>\n<h3>查看网络</h3>\n<pre><code class=\"language-bash\"># IP 地址\nip addr\nip a\n\n# 路由表\nip route\nroute -n\n\n# 网络连接\nss -tuln           # 监听端口\nss -tunp           # 包含进程信息\n</code></pre>\n<h3>配置网络 (Netplan - Ubuntu)</h3>\n<pre><code class=\"language-yaml\"># /etc/netplan/01-config.yaml\n\nnetwork:\n  version: 2\n  ethernets:\n    eth0:\n      dhcp4: false\n      addresses:\n        - 192.168.1.100/24\n      gateway4: 192.168.1.1\n      nameservers:\n        addresses:\n          - 8.8.8.8\n          - 8.8.4.4\n</code></pre>\n<pre><code class=\"language-bash\"># 应用配置\nnetplan apply\n</code></pre>\n<h3>防火墙 (ufw)</h3>\n<pre><code class=\"language-bash\"># 启用/禁用\nufw enable\nufw disable\n\n# 规则管理\nufw allow 22\nufw allow 80/tcp\nufw allow from 192.168.1.0/24\nufw deny 3306\n\n# 查看状态\nufw status\nufw status verbose\n</code></pre>\n<h2>日志管理</h2>\n<h3>系统日志</h3>\n<pre><code class=\"language-bash\"># 常用日志\n/var/log/syslog        # 系统日志\n/var/log/auth.log      # 认证日志\n/var/log/kern.log      # 内核日志\n/var/log/dmesg         # 启动日志\n\n# 查看日志\ntail -f /var/log/syslog\nless /var/log/auth.log\ngrep \"error\" /var/log/syslog\n</code></pre>\n<h3>journalctl</h3>\n<pre><code class=\"language-bash\"># 按时间过滤\njournalctl --since \"2024-01-01\"\njournalctl --since \"1 hour ago\"\njournalctl --since today\n\n# 按优先级\njournalctl -p err      # 错误及以上\njournalctl -p warning\n\n# 磁盘使用\njournalctl --disk-usage\njournalctl --vacuum-size=100M\n</code></pre>\n<h2>定时任务</h2>\n<h3>crontab</h3>\n<pre><code class=\"language-bash\"># 编辑定时任务\ncrontab -e\n\n# 查看任务\ncrontab -l\n\n# 格式: 分 时 日 月 周 命令\n# ┌───────── 分钟 (0-59)\n# │ ┌─────── 小时 (0-23)\n# │ │ ┌───── 日 (1-31)\n# │ │ │ ┌─── 月 (1-12)\n# │ │ │ │ ┌─ 周几 (0-7, 0和7都是周日)\n# * * * * * command\n\n# 示例\n0 2 * * * /scripts/backup.sh       # 每天 2:00\n*/5 * * * * /scripts/check.sh      # 每 5 分钟\n0 0 * * 0 /scripts/weekly.sh       # 每周日 00:00\n</code></pre>\n<h3>systemd timer</h3>\n<pre><code class=\"language-ini\"># /etc/systemd/system/backup.timer\n\n[Unit]\nDescription=Daily backup timer\n\n[Timer]\nOnCalendar=*-*-* 02:00:00\nPersistent=true\n\n[Install]\nWantedBy=timers.target\n</code></pre>\n<pre><code class=\"language-bash\">systemctl enable backup.timer\nsystemctl start backup.timer\nsystemctl list-timers\n</code></pre>\n<h2>总结</h2>\n<p>Linux 系统管理核心技能：</p>\n<ol>\n<li><strong>用户权限</strong>: 合理分配权限，遵循最小权限原则</li>\n<li><strong>进程管理</strong>: 监控资源，及时处理异常进程</li>\n<li><strong>服务管理</strong>: 熟练使用 systemd</li>\n<li><strong>磁盘网络</strong>: 定期检查，预防问题</li>\n<li><strong>日志分析</strong>: 快速定位问题根源</li>\n</ol>\n"
}