{
  "slug": "l7-application",
  "meta": {
    "title": "L7 应用层",
    "description": "应用层协议：HTTP、DNS、FTP 与常用应用协议",
    "order": 6,
    "tags": [
      "应用层",
      "L7",
      "HTTP",
      "DNS"
    ]
  },
  "sections": [
    {
      "type": "keyPoints",
      "title": "核心概念",
      "items": [
        "应用层是 OSI 最顶层，直接服务用户",
        "定义应用程序间的通信规则",
        "HTTP/HTTPS 是 Web 的基础协议",
        "DNS 实现域名到 IP 的解析"
      ]
    },
    {
      "type": "text",
      "title": "应用层概述",
      "content": "应用层是 OSI 模型的第七层，也是最接近用户的一层。它为应用程序提供网络服务，定义了数据的格式和交换规则。常见的应用层协议包括 HTTP（网页）、DNS（域名解析）、FTP（文件传输）、SMTP（邮件）等。"
    },
    {
      "type": "cards",
      "title": "常用应用层协议",
      "layout": "grid",
      "columns": 3,
      "items": [
        {
          "title": "HTTP/HTTPS",
          "badge": "Web",
          "badgeColor": "blue",
          "points": [
            "超文本传输协议",
            "请求-响应模型",
            "HTTPS = HTTP + TLS"
          ]
        },
        {
          "title": "DNS",
          "badge": "解析",
          "badgeColor": "green",
          "points": [
            "域名 → IP 地址",
            "分布式层次结构",
            "缓存加速查询"
          ]
        },
        {
          "title": "FTP/SFTP",
          "badge": "文件",
          "badgeColor": "amber",
          "points": [
            "文件传输协议",
            "主动/被动模式",
            "SFTP 基于 SSH"
          ]
        },
        {
          "title": "SMTP/POP3/IMAP",
          "badge": "邮件",
          "badgeColor": "purple",
          "points": [
            "SMTP 发送邮件",
            "POP3 下载邮件",
            "IMAP 同步邮件"
          ]
        },
        {
          "title": "SSH",
          "badge": "远程",
          "badgeColor": "gray",
          "points": [
            "安全远程登录",
            "加密通道",
            "端口转发/隧道"
          ]
        },
        {
          "title": "WebSocket",
          "badge": "实时",
          "badgeColor": "red",
          "points": [
            "全双工通信",
            "持久连接",
            "实时推送"
          ]
        }
      ]
    },
    {
      "type": "flow",
      "title": "HTTP 请求流程",
      "direction": "horizontal",
      "steps": [
        {
          "label": "DNS 解析",
          "description": "域名 → IP",
          "color": "bg-green-500"
        },
        {
          "label": "TCP 连接",
          "description": "三次握手",
          "color": "bg-blue-500"
        },
        {
          "label": "TLS 握手",
          "description": "HTTPS",
          "color": "bg-purple-500"
        },
        {
          "label": "HTTP 请求",
          "description": "发送请求",
          "color": "bg-cyan-500"
        },
        {
          "label": "HTTP 响应",
          "description": "返回数据",
          "color": "bg-amber-500"
        }
      ]
    },
    {
      "type": "comparison",
      "title": "HTTP 版本对比",
      "columns": [
        {
          "title": "HTTP/1.1",
          "color": "from-gray-500 to-gray-600",
          "items": [
            {
              "label": "连接",
              "description": "Keep-Alive 复用"
            },
            {
              "label": "传输",
              "description": "文本格式"
            },
            {
              "label": "多路复用",
              "description": "不支持"
            },
            {
              "label": "头部",
              "description": "无压缩"
            }
          ]
        },
        {
          "title": "HTTP/2",
          "color": "from-blue-500 to-cyan-500",
          "items": [
            {
              "label": "连接",
              "description": "单连接多流"
            },
            {
              "label": "传输",
              "description": "二进制帧"
            },
            {
              "label": "多路复用",
              "description": "支持"
            },
            {
              "label": "头部",
              "description": "HPACK 压缩"
            }
          ]
        },
        {
          "title": "HTTP/3",
          "color": "from-green-500 to-emerald-500",
          "items": [
            {
              "label": "连接",
              "description": "QUIC (UDP)"
            },
            {
              "label": "传输",
              "description": "二进制帧"
            },
            {
              "label": "多路复用",
              "description": "无队头阻塞"
            },
            {
              "label": "握手",
              "description": "0-RTT"
            }
          ]
        }
      ]
    },
    {
      "type": "codeBlock",
      "title": "HTTP 请求/响应",
      "language": "http",
      "code": "# 请求\nGET /api/users HTTP/1.1\nHost: api.example.com\nAuthorization: Bearer token123\nAccept: application/json\n\n# 响应\nHTTP/1.1 200 OK\nContent-Type: application/json\nCache-Control: max-age=3600\n\n{\"id\": 1, \"name\": \"John\"}"
    },
    {
      "type": "table",
      "title": "HTTP 状态码",
      "highlightFirst": true,
      "headers": [
        "范围",
        "类型",
        "常见状态码"
      ],
      "rows": [
        [
          "1xx",
          "信息",
          "100 Continue, 101 Switching"
        ],
        [
          "2xx",
          "成功",
          "200 OK, 201 Created, 204 No Content"
        ],
        [
          "3xx",
          "重定向",
          "301 永久, 302 临时, 304 未修改"
        ],
        [
          "4xx",
          "客户端错误",
          "400 Bad, 401 未授权, 404 Not Found"
        ],
        [
          "5xx",
          "服务端错误",
          "500 内部错误, 502 Bad Gateway, 503 不可用"
        ]
      ]
    },
    {
      "type": "flow",
      "title": "DNS 解析流程",
      "direction": "horizontal",
      "steps": [
        {
          "label": "本地缓存",
          "description": "浏览器/系统",
          "color": "bg-gray-500"
        },
        {
          "label": "本地 DNS",
          "description": "ISP 递归",
          "color": "bg-blue-500"
        },
        {
          "label": "根服务器",
          "description": ". (root)",
          "color": "bg-purple-500"
        },
        {
          "label": "TLD 服务器",
          "description": ".com/.cn",
          "color": "bg-cyan-500"
        },
        {
          "label": "权威 DNS",
          "description": "最终解析",
          "color": "bg-green-500"
        }
      ]
    },
    {
      "type": "table",
      "title": "DNS 记录类型",
      "highlightFirst": true,
      "headers": [
        "类型",
        "用途",
        "示例"
      ],
      "rows": [
        [
          "A",
          "IPv4 地址",
          "example.com → 1.2.3.4"
        ],
        [
          "AAAA",
          "IPv6 地址",
          "example.com → 2001:db8::1"
        ],
        [
          "CNAME",
          "别名",
          "www → example.com"
        ],
        [
          "MX",
          "邮件服务器",
          "@ → mail.example.com"
        ],
        [
          "TXT",
          "文本记录",
          "SPF, DKIM 验证"
        ],
        [
          "NS",
          "名称服务器",
          "@ → ns1.example.com"
        ]
      ]
    },
    {
      "type": "codeBlock",
      "title": "常用诊断命令",
      "language": "bash",
      "code": "# DNS 查询\nnslookup example.com\ndig example.com A\ndig +trace example.com\n\n# HTTP 请求\ncurl -v https://example.com\ncurl -I https://example.com  # 只看头部\n\n# 测试端口连通性\ntelnet example.com 80\nnc -zv example.com 443"
    },
    {
      "type": "list",
      "title": "最佳实践",
      "style": "check",
      "items": [
        {
          "label": "使用 HTTPS",
          "description": "TLS 加密保护数据安全"
        },
        {
          "label": "启用 HTTP/2",
          "description": "多路复用提升性能"
        },
        {
          "label": "合理缓存",
          "description": "Cache-Control 减少请求"
        },
        {
          "label": "DNS 预解析",
          "description": "dns-prefetch 减少延迟"
        }
      ]
    }
  ],
  "relatedTopics": [
    "L4 传输层",
    "负载均衡",
    "Web 安全"
  ]
}