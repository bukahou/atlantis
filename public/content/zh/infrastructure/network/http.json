{
  "slug": "http",
  "meta": {
    "title": "HTTP 协议详解",
    "description": "深入理解 HTTP/HTTPS 协议原理与实践",
    "order": 3,
    "tags": [
      "network",
      "http",
      "https",
      "web"
    ]
  },
  "content": "<h1>HTTP 协议详解</h1>\n<h2>HTTP 基础</h2>\n<p>HTTP (HyperText Transfer Protocol) 是 Web 通信的基础协议，基于请求-响应模型。</p>\n<h3>HTTP 版本演进</h3>\n<table>\n<thead>\n<tr>\n<th>版本</th>\n<th>年份</th>\n<th>特点</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>HTTP/0.9</td>\n<td>1991</td>\n<td>仅支持 GET，无头部</td>\n</tr>\n<tr>\n<td>HTTP/1.0</td>\n<td>1996</td>\n<td>引入头部、状态码、POST</td>\n</tr>\n<tr>\n<td>HTTP/1.1</td>\n<td>1997</td>\n<td>持久连接、管道化、Host 头</td>\n</tr>\n<tr>\n<td>HTTP/2</td>\n<td>2015</td>\n<td>多路复用、头部压缩、服务器推送</td>\n</tr>\n<tr>\n<td>HTTP/3</td>\n<td>2022</td>\n<td>基于 QUIC (UDP)、更低延迟</td>\n</tr>\n</tbody>\n</table>\n<h2>请求与响应</h2>\n<h3>请求结构</h3>\n<pre><code class=\"language-http\">GET /api/users HTTP/1.1\nHost: example.com\nUser-Agent: Mozilla/5.0\nAccept: application/json\nAuthorization: Bearer token123\nContent-Type: application/json\n\n{\"name\": \"John\"}\n</code></pre>\n<pre><code>┌─────────────────────────────────┐\n│ 请求行: 方法 路径 协议版本        │\n├─────────────────────────────────┤\n│ 请求头部                         │\n│ Host: example.com               │\n│ Content-Type: application/json  │\n├─────────────────────────────────┤\n│ 空行                             │\n├─────────────────────────────────┤\n│ 请求体 (可选)                    │\n└─────────────────────────────────┘\n</code></pre>\n<h3>响应结构</h3>\n<pre><code class=\"language-http\">HTTP/1.1 200 OK\nContent-Type: application/json\nContent-Length: 27\nCache-Control: max-age=3600\n\n{\"id\": 1, \"name\": \"John\"}\n</code></pre>\n<pre><code>┌─────────────────────────────────┐\n│ 状态行: 协议版本 状态码 状态描述   │\n├─────────────────────────────────┤\n│ 响应头部                         │\n│ Content-Type: application/json  │\n│ Content-Length: 27              │\n├─────────────────────────────────┤\n│ 空行                             │\n├─────────────────────────────────┤\n│ 响应体                           │\n└─────────────────────────────────┘\n</code></pre>\n<h2>HTTP 方法</h2>\n<table>\n<thead>\n<tr>\n<th>方法</th>\n<th>用途</th>\n<th>幂等</th>\n<th>安全</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>GET</strong></td>\n<td>获取资源</td>\n<td>是</td>\n<td>是</td>\n</tr>\n<tr>\n<td><strong>POST</strong></td>\n<td>创建资源</td>\n<td>否</td>\n<td>否</td>\n</tr>\n<tr>\n<td><strong>PUT</strong></td>\n<td>替换资源</td>\n<td>是</td>\n<td>否</td>\n</tr>\n<tr>\n<td><strong>PATCH</strong></td>\n<td>部分更新</td>\n<td>否</td>\n<td>否</td>\n</tr>\n<tr>\n<td><strong>DELETE</strong></td>\n<td>删除资源</td>\n<td>是</td>\n<td>否</td>\n</tr>\n<tr>\n<td><strong>HEAD</strong></td>\n<td>获取头部</td>\n<td>是</td>\n<td>是</td>\n</tr>\n<tr>\n<td><strong>OPTIONS</strong></td>\n<td>查询支持方法</td>\n<td>是</td>\n<td>是</td>\n</tr>\n</tbody>\n</table>\n<h3>RESTful 示例</h3>\n<pre><code class=\"language-bash\"># 获取用户列表\nGET /api/users\n\n# 获取单个用户\nGET /api/users/123\n\n# 创建用户\nPOST /api/users\nContent-Type: application/json\n{\"name\": \"John\", \"email\": \"john@example.com\"}\n\n# 更新用户\nPUT /api/users/123\nContent-Type: application/json\n{\"name\": \"John Doe\", \"email\": \"john@example.com\"}\n\n# 删除用户\nDELETE /api/users/123\n</code></pre>\n<h2>状态码</h2>\n<h3>分类</h3>\n<table>\n<thead>\n<tr>\n<th>范围</th>\n<th>类别</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1xx</td>\n<td>信息</td>\n<td>请求已接收，继续处理</td>\n</tr>\n<tr>\n<td>2xx</td>\n<td>成功</td>\n<td>请求已成功处理</td>\n</tr>\n<tr>\n<td>3xx</td>\n<td>重定向</td>\n<td>需要进一步操作</td>\n</tr>\n<tr>\n<td>4xx</td>\n<td>客户端错误</td>\n<td>请求有误</td>\n</tr>\n<tr>\n<td>5xx</td>\n<td>服务器错误</td>\n<td>服务器处理失败</td>\n</tr>\n</tbody>\n</table>\n<h3>常用状态码</h3>\n<pre><code>200 OK                    请求成功\n201 Created               资源已创建\n204 No Content            成功但无返回内容\n\n301 Moved Permanently     永久重定向\n302 Found                 临时重定向\n304 Not Modified          资源未修改 (缓存有效)\n\n400 Bad Request           请求语法错误\n401 Unauthorized          未认证\n403 Forbidden             无权限\n404 Not Found             资源不存在\n405 Method Not Allowed    方法不允许\n429 Too Many Requests     请求过多\n\n500 Internal Server Error 服务器内部错误\n502 Bad Gateway           网关错误\n503 Service Unavailable   服务不可用\n504 Gateway Timeout       网关超时\n</code></pre>\n<h2>常用头部</h2>\n<h3>请求头</h3>\n<table>\n<thead>\n<tr>\n<th>头部</th>\n<th>说明</th>\n<th>示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>Host</code></td>\n<td>目标主机</td>\n<td><code>example.com</code></td>\n</tr>\n<tr>\n<td><code>User-Agent</code></td>\n<td>客户端标识</td>\n<td><code>Mozilla/5.0...</code></td>\n</tr>\n<tr>\n<td><code>Accept</code></td>\n<td>接受的内容类型</td>\n<td><code>application/json</code></td>\n</tr>\n<tr>\n<td><code>Content-Type</code></td>\n<td>请求体类型</td>\n<td><code>application/json</code></td>\n</tr>\n<tr>\n<td><code>Authorization</code></td>\n<td>认证凭证</td>\n<td><code>Bearer token123</code></td>\n</tr>\n<tr>\n<td><code>Cookie</code></td>\n<td>Cookie 数据</td>\n<td><code>session=abc123</code></td>\n</tr>\n<tr>\n<td><code>Cache-Control</code></td>\n<td>缓存控制</td>\n<td><code>no-cache</code></td>\n</tr>\n</tbody>\n</table>\n<h3>响应头</h3>\n<table>\n<thead>\n<tr>\n<th>头部</th>\n<th>说明</th>\n<th>示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>Content-Type</code></td>\n<td>响应体类型</td>\n<td><code>text/html; charset=utf-8</code></td>\n</tr>\n<tr>\n<td><code>Content-Length</code></td>\n<td>响应体长度</td>\n<td><code>1234</code></td>\n</tr>\n<tr>\n<td><code>Set-Cookie</code></td>\n<td>设置 Cookie</td>\n<td><code>session=abc; HttpOnly</code></td>\n</tr>\n<tr>\n<td><code>Cache-Control</code></td>\n<td>缓存控制</td>\n<td><code>max-age=3600</code></td>\n</tr>\n<tr>\n<td><code>Location</code></td>\n<td>重定向地址</td>\n<td><code>https://new.example.com</code></td>\n</tr>\n<tr>\n<td><code>Access-Control-*</code></td>\n<td>CORS 相关</td>\n<td><code>Access-Control-Allow-Origin: *</code></td>\n</tr>\n</tbody>\n</table>\n<h2>缓存机制</h2>\n<h3>缓存控制</h3>\n<pre><code class=\"language-http\"># 响应可缓存 1 小时\nCache-Control: max-age=3600\n\n# 禁止缓存\nCache-Control: no-store\n\n# 每次需验证\nCache-Control: no-cache\n\n# 私有缓存 (浏览器可缓存)\nCache-Control: private, max-age=3600\n\n# 公共缓存 (CDN 可缓存)\nCache-Control: public, max-age=86400\n</code></pre>\n<h3>条件请求</h3>\n<pre><code class=\"language-http\"># 服务器返回\nETag: \"abc123\"\nLast-Modified: Wed, 01 Jan 2024 00:00:00 GMT\n\n# 客户端验证\nIf-None-Match: \"abc123\"\nIf-Modified-Since: Wed, 01 Jan 2024 00:00:00 GMT\n\n# 未修改返回 304\nHTTP/1.1 304 Not Modified\n</code></pre>\n<h2>HTTPS</h2>\n<h3>TLS 握手</h3>\n<pre><code>客户端                          服务器\n   │                              │\n   │  ──── Client Hello ────────> │  支持的加密套件\n   │                              │\n   │  &#x3C;─── Server Hello ───────── │  选择加密套件\n   │  &#x3C;─── Certificate ────────── │  服务器证书\n   │  &#x3C;─── Server Hello Done ──── │\n   │                              │\n   │  ──── Key Exchange ────────> │  密钥交换\n   │  ──── Change Cipher Spec ──> │\n   │  ──── Finished ────────────> │\n   │                              │\n   │  &#x3C;─── Change Cipher Spec ─── │\n   │  &#x3C;─── Finished ───────────── │\n   │                              │\n   │      加密通信开始             │\n</code></pre>\n<h3>证书配置 (Nginx)</h3>\n<pre><code class=\"language-nginx\">server {\n    listen 443 ssl http2;\n    server_name example.com;\n\n    ssl_certificate     /etc/ssl/certs/example.com.crt;\n    ssl_certificate_key /etc/ssl/private/example.com.key;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;\n    ssl_prefer_server_ciphers on;\n\n    # HSTS\n    add_header Strict-Transport-Security \"max-age=31536000\" always;\n}\n</code></pre>\n<h2>CORS 跨域</h2>\n<h3>简单请求</h3>\n<pre><code class=\"language-http\"># 请求\nGET /api/data HTTP/1.1\nOrigin: https://example.com\n\n# 响应\nAccess-Control-Allow-Origin: https://example.com\n</code></pre>\n<h3>预检请求</h3>\n<pre><code class=\"language-http\"># 预检请求\nOPTIONS /api/data HTTP/1.1\nOrigin: https://example.com\nAccess-Control-Request-Method: POST\nAccess-Control-Request-Headers: Content-Type\n\n# 预检响应\nAccess-Control-Allow-Origin: https://example.com\nAccess-Control-Allow-Methods: GET, POST, PUT, DELETE\nAccess-Control-Allow-Headers: Content-Type\nAccess-Control-Max-Age: 86400\n</code></pre>\n<h2>调试工具</h2>\n<h3>curl</h3>\n<pre><code class=\"language-bash\"># GET 请求\ncurl https://api.example.com/users\n\n# POST 请求\ncurl -X POST https://api.example.com/users \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"name\": \"John\"}'\n\n# 查看响应头\ncurl -I https://example.com\n\n# 详细输出\ncurl -v https://example.com\n\n# 跟随重定向\ncurl -L https://example.com\n</code></pre>\n<h3>浏览器开发者工具</h3>\n<ul>\n<li><strong>Network 面板</strong>: 查看所有请求</li>\n<li><strong>Headers</strong>: 请求/响应头</li>\n<li><strong>Preview/Response</strong>: 响应内容</li>\n<li><strong>Timing</strong>: 请求时间分析</li>\n</ul>\n<h2>总结</h2>\n<p>HTTP 协议核心要点：</p>\n<ol>\n<li><strong>请求方法</strong>: GET、POST、PUT、DELETE 各有语义</li>\n<li><strong>状态码</strong>: 正确使用状态码表达结果</li>\n<li><strong>头部</strong>: 控制缓存、认证、内容协商</li>\n<li><strong>HTTPS</strong>: TLS 加密保护传输安全</li>\n<li><strong>CORS</strong>: 跨域资源共享机制</li>\n</ol>\n"
}